(()=>{var a={};a.id=698,a.ids=[698],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5868:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,64609)),"C:\\Users\\hirok\\Dropbox\\F.ソースデータ\\0A.LINE_LIFE_TSUKUBA\\260209_ManagimentAPPs_01\\app\\admin\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(c.bind(c,86945)),"C:\\Users\\hirok\\Dropbox\\F.ソースデータ\\0A.LINE_LIFE_TSUKUBA\\260209_ManagimentAPPs_01\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(c.bind(c,16953)),"C:\\Users\\hirok\\Dropbox\\F.ソースデータ\\0A.LINE_LIFE_TSUKUBA\\260209_ManagimentAPPs_01\\app\\layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"]}]}.children,I=["C:\\Users\\hirok\\Dropbox\\F.ソースデータ\\0A.LINE_LIFE_TSUKUBA\\260209_ManagimentAPPs_01\\app\\admin\\page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/admin/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},7240:(a,b,c)=>{"use strict";function d(a){let b=new Date(a);return new Intl.DateTimeFormat("ja-JP",{timeZone:"Asia/Tokyo",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(b)}c.d(b,{B:()=>d})},7629:(a,b,c)=>{"use strict";c.d(b,{p:()=>g});var d=c(21124),e=c(38301),f=c(15514);let g=e.forwardRef(({className:a,type:b,...c},e)=>(0,d.jsx)("input",{type:b,className:(0,f.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:e,...c}));g.displayName="Input"},10350:(a,b,c)=>{"use strict";c.d(b,{Z:()=>e});var d=c(38301);function e(a){let b=d.useRef({value:a,previous:a});return d.useMemo(()=>(b.current.value!==a&&(b.current.previous=b.current.value,b.current.value=a),b.current.previous),[a])}},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15373:(a,b,c)=>{"use strict";c.d(b,{PatientsTable:()=>b1});var d=c(21124),e=c(38301),f=c(52300),g=c(7240);function h(a){if(!a)return null;let[b,c,d]=a.split("-").map(Number);return`${b}年${c}月${d}日`}function i(a){if(!a)return!1;let b=new Date;return b.setHours(0,0,0,0),new Date(a+"T00:00:00")<b}var j=c(22544),k=c(19217),l=c(7629),m=c(53199),n=c(33305),o=c(17677),p=c(6843),q=c(26691),r=c(47089),s=c(15514);let t=p.bL;p.l9,p.bm;let u=p.ZL,v=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(p.hJ,{className:(0,s.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b,ref:c}));v.displayName=p.hJ.displayName;let w=(0,q.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),x=e.forwardRef(({side:a="right",className:b,children:c,showClose:e=!0,...f},g)=>(0,d.jsxs)(u,{children:[(0,d.jsx)(v,{}),(0,d.jsxs)(p.UC,{ref:g,className:(0,s.cn)(w({side:a}),b),...f,children:[c,e&&(0,d.jsxs)(p.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,d.jsx)(r.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"閉じる"})]})]})]}));x.displayName=p.UC.displayName;let y=({className:a,...b})=>(0,d.jsx)("div",{className:(0,s.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...b});y.displayName="SheetHeader";let z=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(p.hE,{ref:c,className:(0,s.cn)("text-lg font-semibold leading-none tracking-tight",a),...b}));z.displayName=p.hE.displayName;let A=({className:a,...b})=>(0,d.jsx)("div",{className:(0,s.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...b});A.displayName="SheetFooter";let B=["お疲れ様でした。","次回予約は〇〇です。よろしくお願いします。","検診のお知らせです。","ご来院ありがとうございました。"];function C({profile:a,open:b,onOpenChange:c}){let[f,g]=(0,e.useState)(""),[h,i]=(0,e.useState)(""),[j,l]=(0,e.useState)(!1),[n,o]=(0,e.useState)(!1),[p,q]=(0,e.useState)(!1),r=[f,h].filter(Boolean).join("\n\n");async function s(){if(r.trim()){l(!0);try{let b=await fetch(`/api/profiles/${a.id}/care-messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({body:r.trim()})});if(!b.ok){let a=await b.json().catch(()=>({}));alert(a.error||"送信に失敗しました。");return}let d=await b.json();q("sent"===d.line_push),o(!0),g(""),i(""),setTimeout(()=>{c(!1),o(!1)},1500)}finally{l(!1)}}}return(0,d.jsx)(t,{open:b,onOpenChange:c,children:(0,d.jsxs)(x,{side:"right",className:"flex flex-col w-full sm:max-w-md",children:[(0,d.jsx)(y,{children:(0,d.jsx)(z,{children:"個別メッセージ送信"})}),(0,d.jsxs)("div",{className:"flex-1 space-y-4 py-4 overflow-auto",children:[(0,d.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.display_name||"—"," さんへ送信します。内容はケア記録に保存され、患者側の「ケア記録」タブでも確認できます。"]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(m.J,{children:"定型文（任意）"}),(0,d.jsxs)("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",value:f,onChange:a=>g(a.target.value),children:[(0,d.jsx)("option",{value:"",children:"選択してください"}),B.map(a=>(0,d.jsx)("option",{value:a,children:a},a))]})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(m.J,{htmlFor:"free-text",children:"自由入力"}),(0,d.jsx)("textarea",{id:"free-text",className:"flex min-h-[120px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",placeholder:"追加のメッセージを入力...",value:h,onChange:a=>i(a.target.value)})]}),n&&(0,d.jsx)("p",{className:"text-sm text-green-600",children:p?"送信しました。ケア記録に保存し、LINEにもプッシュしました。":"送信しました。ケア記録に保存されています。（LINE は未設定または送信スキップ）"})]}),(0,d.jsxs)(A,{children:[(0,d.jsx)(k.$,{variant:"outline",onClick:()=>c(!1),children:"キャンセル"}),(0,d.jsx)(k.$,{onClick:s,disabled:!r.trim()||j,children:j?"送信中...":"送信して記録に保存"})]})]})})}var D=c(87868),E=c(92808),F=c(2332),G=c(11720),H=c(10350),I=c(96386),J=c(99978),K="Switch",[L,M]=(0,F.A)(K),[N,O]=L(K),P=e.forwardRef((a,b)=>{let{__scopeSwitch:c,name:f,checked:g,defaultChecked:h,required:i,disabled:j,value:k="on",onCheckedChange:l,form:m,...n}=a,[o,p]=e.useState(null),q=(0,E.s)(b,a=>p(a)),r=e.useRef(!1),s=!o||m||!!o.closest("form"),[t,u]=(0,G.i)({prop:g,defaultProp:h??!1,onChange:l,caller:K});return(0,d.jsxs)(N,{scope:c,checked:t,disabled:j,children:[(0,d.jsx)(J.sG.button,{type:"button",role:"switch","aria-checked":t,"aria-required":i,"data-state":T(t),"data-disabled":j?"":void 0,disabled:j,value:k,...n,ref:q,onClick:(0,D.mK)(a.onClick,a=>{u(a=>!a),s&&(r.current=a.isPropagationStopped(),r.current||a.stopPropagation())})}),s&&(0,d.jsx)(S,{control:o,bubbles:!r.current,name:f,value:k,checked:t,required:i,disabled:j,form:m,style:{transform:"translateX(-100%)"}})]})});P.displayName=K;var Q="SwitchThumb",R=e.forwardRef((a,b)=>{let{__scopeSwitch:c,...e}=a,f=O(Q,c);return(0,d.jsx)(J.sG.span,{"data-state":T(f.checked),"data-disabled":f.disabled?"":void 0,...e,ref:b})});R.displayName=Q;var S=e.forwardRef(({__scopeSwitch:a,control:b,checked:c,bubbles:f=!0,...g},h)=>{let i=e.useRef(null),j=(0,E.s)(i,h),k=(0,H.Z)(c),l=(0,I.X)(b);return e.useEffect(()=>{let a=i.current;if(!a)return;let b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(k!==c&&b){let d=new Event("click",{bubbles:f});b.call(a,c),a.dispatchEvent(d)}},[k,c,f]),(0,d.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:c,...g,tabIndex:-1,ref:j,style:{...g.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function T(a){return a?"checked":"unchecked"}S.displayName="SwitchBubbleInput";let U=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(P,{className:(0,s.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...b,ref:c,children:(0,d.jsx)(R,{className:(0,s.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));U.displayName=P.displayName;var V=c(23339);let W=(0,V.A)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),X=(0,V.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Y=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:c,...b}));Y.displayName="Textarea",c(23312);var Z=c(96425),$=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,b)=>{let c=(0,Z.TL)(`Primitive.${b}`),f=e.forwardRef((a,e)=>{let{asChild:f,...g}=a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,d.jsx)(f?c:b,{...g,ref:e})});return f.displayName=`Primitive.${b}`,{...a,[b]:f}},{}),_="horizontal",aa=["horizontal","vertical"],ab=e.forwardRef((a,b)=>{var c;let{decorative:e,orientation:f=_,...g}=a,h=(c=f,aa.includes(c))?f:_;return(0,d.jsx)($.div,{"data-orientation":h,...e?{role:"none"}:{"aria-orientation":"vertical"===h?h:void 0,role:"separator"},...g,ref:b})});ab.displayName="Separator";let ac=e.forwardRef(({className:a,orientation:b="horizontal",decorative:c=!0,...e},f)=>(0,d.jsx)(ab,{ref:f,decorative:c,orientation:b,className:(0,s.cn)("shrink-0 bg-border","horizontal"===b?"h-[1px] w-full":"h-full w-[1px]",a),...e}));ac.displayName=ab.displayName;var ad=c(43515),ae=c(10498),af=c(7412),ag=c(70904),ah=c(69998),ai=c(75656),aj=c(25122),ak=c(61611),al=c(29988),am=c(88617),an=Symbol("radix.slottable");function ao(a){return e.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===an}var ap=c(71700),aq=c(61225),ar=c(36409),as=["Enter"," "],at=["ArrowUp","PageDown","End"],au=["ArrowDown","PageUp","Home",...at],av={ltr:[...as,"ArrowRight"],rtl:[...as,"ArrowLeft"]},aw={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ax="Menu",[ay,az,aA]=(0,ad.N)(ax),[aB,aC]=(0,F.A)(ax,[aA,aj.Bk,am.RG]),aD=(0,aj.Bk)(),aE=(0,am.RG)(),[aF,aG]=aB(ax),[aH,aI]=aB(ax),aJ=a=>{let{__scopeMenu:b,open:c=!1,children:f,dir:g,onOpenChange:h,modal:i=!0}=a,j=aD(b),[k,l]=e.useState(null),m=e.useRef(!1),n=(0,ap.c)(h),o=(0,ae.jH)(g);return e.useEffect(()=>{let a=()=>{m.current=!0,document.addEventListener("pointerdown",b,{capture:!0,once:!0}),document.addEventListener("pointermove",b,{capture:!0,once:!0})},b=()=>m.current=!1;return document.addEventListener("keydown",a,{capture:!0}),()=>{document.removeEventListener("keydown",a,{capture:!0}),document.removeEventListener("pointerdown",b,{capture:!0}),document.removeEventListener("pointermove",b,{capture:!0})}},[]),(0,d.jsx)(aj.bL,{...j,children:(0,d.jsx)(aF,{scope:b,open:c,onOpenChange:n,content:k,onContentChange:l,children:(0,d.jsx)(aH,{scope:b,onClose:e.useCallback(()=>n(!1),[n]),isUsingKeyboardRef:m,dir:o,modal:i,children:f})})})};aJ.displayName=ax;var aK=e.forwardRef((a,b)=>{let{__scopeMenu:c,...e}=a,f=aD(c);return(0,d.jsx)(aj.Mz,{...f,...e,ref:b})});aK.displayName="MenuAnchor";var aL="MenuPortal",[aM,aN]=aB(aL,{forceMount:void 0}),aO=a=>{let{__scopeMenu:b,forceMount:c,children:e,container:f}=a,g=aG(aL,b);return(0,d.jsx)(aM,{scope:b,forceMount:c,children:(0,d.jsx)(al.C,{present:c||g.open,children:(0,d.jsx)(ak.Z,{asChild:!0,container:f,children:e})})})};aO.displayName=aL;var aP="MenuContent",[aQ,aR]=aB(aP),aS=e.forwardRef((a,b)=>{let c=aN(aP,a.__scopeMenu),{forceMount:e=c.forceMount,...f}=a,g=aG(aP,a.__scopeMenu),h=aI(aP,a.__scopeMenu);return(0,d.jsx)(ay.Provider,{scope:a.__scopeMenu,children:(0,d.jsx)(al.C,{present:e||g.open,children:(0,d.jsx)(ay.Slot,{scope:a.__scopeMenu,children:h.modal?(0,d.jsx)(aT,{...f,ref:b}):(0,d.jsx)(aU,{...f,ref:b})})})})}),aT=e.forwardRef((a,b)=>{let c=aG(aP,a.__scopeMenu),f=e.useRef(null),g=(0,E.s)(b,f);return e.useEffect(()=>{let a=f.current;if(a)return(0,aq.Eq)(a)},[]),(0,d.jsx)(aW,{...a,ref:g,trapFocus:c.open,disableOutsidePointerEvents:c.open,disableOutsideScroll:!0,onFocusOutside:(0,D.mK)(a.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>c.onOpenChange(!1)})}),aU=e.forwardRef((a,b)=>{let c=aG(aP,a.__scopeMenu);return(0,d.jsx)(aW,{...a,ref:b,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>c.onOpenChange(!1)})}),aV=function(a){let b=function(a){let b=e.forwardRef((a,b)=>{let{children:c,...d}=a;if(e.isValidElement(c)){var f;let a,g,h=(f=c,(g=(a=Object.getOwnPropertyDescriptor(f.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?f.ref:(g=(a=Object.getOwnPropertyDescriptor(f,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?f.props.ref:f.props.ref||f.ref),i=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==e.Fragment&&(i.ref=b?(0,E.t)(b,h):h),e.cloneElement(c,i)}return e.Children.count(c)>1?e.Children.only(null):null});return b.displayName=`${a}.SlotClone`,b}(a),c=e.forwardRef((a,c)=>{let{children:f,...g}=a,h=e.Children.toArray(f),i=h.find(ao);if(i){let a=i.props.children,f=h.map(b=>b!==i?b:e.Children.count(a)>1?e.Children.only(null):e.isValidElement(a)?a.props.children:null);return(0,d.jsx)(b,{...g,ref:c,children:e.isValidElement(a)?e.cloneElement(a,void 0,f):null})}return(0,d.jsx)(b,{...g,ref:c,children:f})});return c.displayName=`${a}.Slot`,c}("MenuContent.ScrollLock"),aW=e.forwardRef((a,b)=>{let{__scopeMenu:c,loop:f=!1,trapFocus:g,onOpenAutoFocus:h,onCloseAutoFocus:i,disableOutsidePointerEvents:j,onEntryFocus:k,onEscapeKeyDown:l,onPointerDownOutside:m,onFocusOutside:n,onInteractOutside:o,onDismiss:p,disableOutsideScroll:q,...r}=a,s=aG(aP,c),t=aI(aP,c),u=aD(c),v=aE(c),w=az(c),[x,y]=e.useState(null),z=e.useRef(null),A=(0,E.s)(b,z,s.onContentChange),B=e.useRef(0),C=e.useRef(""),F=e.useRef(0),G=e.useRef(null),H=e.useRef("right"),I=e.useRef(0),J=q?ar.A:e.Fragment;e.useEffect(()=>()=>window.clearTimeout(B.current),[]),(0,ag.Oh)();let K=e.useCallback(a=>H.current===G.current?.side&&function(a,b){return!!b&&function(a,b){let{x:c,y:d}=a,e=!1;for(let a=0,f=b.length-1;a<b.length;f=a++){let g=b[a],h=b[f],i=g.x,j=g.y,k=h.x,l=h.y;j>d!=l>d&&c<(k-i)*(d-j)/(l-j)+i&&(e=!e)}return e}({x:a.clientX,y:a.clientY},b)}(a,G.current?.area),[]);return(0,d.jsx)(aQ,{scope:c,searchRef:C,onItemEnter:e.useCallback(a=>{K(a)&&a.preventDefault()},[K]),onItemLeave:e.useCallback(a=>{K(a)||(z.current?.focus(),y(null))},[K]),onTriggerLeave:e.useCallback(a=>{K(a)&&a.preventDefault()},[K]),pointerGraceTimerRef:F,onPointerGraceIntentChange:e.useCallback(a=>{G.current=a},[]),children:(0,d.jsx)(J,{...q?{as:aV,allowPinchZoom:!0}:void 0,children:(0,d.jsx)(ah.n,{asChild:!0,trapped:g,onMountAutoFocus:(0,D.mK)(h,a=>{a.preventDefault(),z.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:(0,d.jsx)(af.qW,{asChild:!0,disableOutsidePointerEvents:j,onEscapeKeyDown:l,onPointerDownOutside:m,onFocusOutside:n,onInteractOutside:o,onDismiss:p,children:(0,d.jsx)(am.bL,{asChild:!0,...v,dir:t.dir,orientation:"vertical",loop:f,currentTabStopId:x,onCurrentTabStopIdChange:y,onEntryFocus:(0,D.mK)(k,a=>{t.isUsingKeyboardRef.current||a.preventDefault()}),preventScrollOnEntryFocus:!0,children:(0,d.jsx)(aj.UC,{role:"menu","aria-orientation":"vertical","data-state":bk(s.open),"data-radix-menu-content":"",dir:t.dir,...u,...r,ref:A,style:{outline:"none",...r.style},onKeyDown:(0,D.mK)(r.onKeyDown,a=>{let b=a.target.closest("[data-radix-menu-content]")===a.currentTarget,c=a.ctrlKey||a.altKey||a.metaKey,d=1===a.key.length;b&&("Tab"===a.key&&a.preventDefault(),!c&&d&&(a=>{let b=C.current+a,c=w().filter(a=>!a.disabled),d=document.activeElement,e=c.find(a=>a.ref.current===d)?.textValue,f=function(a,b,c){var d;let e=b.length>1&&Array.from(b).every(a=>a===b[0])?b[0]:b,f=c?a.indexOf(c):-1,g=(d=Math.max(f,0),a.map((b,c)=>a[(d+c)%a.length]));1===e.length&&(g=g.filter(a=>a!==c));let h=g.find(a=>a.toLowerCase().startsWith(e.toLowerCase()));return h!==c?h:void 0}(c.map(a=>a.textValue),b,e),g=c.find(a=>a.textValue===f)?.ref.current;!function a(b){C.current=b,window.clearTimeout(B.current),""!==b&&(B.current=window.setTimeout(()=>a(""),1e3))}(b),g&&setTimeout(()=>g.focus())})(a.key));let e=z.current;if(a.target!==e||!au.includes(a.key))return;a.preventDefault();let f=w().filter(a=>!a.disabled).map(a=>a.ref.current);at.includes(a.key)&&f.reverse(),function(a){let b=document.activeElement;for(let c of a)if(c===b||(c.focus(),document.activeElement!==b))return}(f)}),onBlur:(0,D.mK)(a.onBlur,a=>{a.currentTarget.contains(a.target)||(window.clearTimeout(B.current),C.current="")}),onPointerMove:(0,D.mK)(a.onPointerMove,bn(a=>{let b=a.target,c=I.current!==a.clientX;a.currentTarget.contains(b)&&c&&(H.current=a.clientX>I.current?"right":"left",I.current=a.clientX)}))})})})})})})});aS.displayName=aP;var aX=e.forwardRef((a,b)=>{let{__scopeMenu:c,...e}=a;return(0,d.jsx)(J.sG.div,{role:"group",...e,ref:b})});aX.displayName="MenuGroup";var aY=e.forwardRef((a,b)=>{let{__scopeMenu:c,...e}=a;return(0,d.jsx)(J.sG.div,{...e,ref:b})});aY.displayName="MenuLabel";var aZ="MenuItem",a$="menu.itemSelect",a_=e.forwardRef((a,b)=>{let{disabled:c=!1,onSelect:f,...g}=a,h=e.useRef(null),i=aI(aZ,a.__scopeMenu),j=aR(aZ,a.__scopeMenu),k=(0,E.s)(b,h),l=e.useRef(!1);return(0,d.jsx)(a0,{...g,ref:k,disabled:c,onClick:(0,D.mK)(a.onClick,()=>{let a=h.current;if(!c&&a){let b=new CustomEvent(a$,{bubbles:!0,cancelable:!0});a.addEventListener(a$,a=>f?.(a),{once:!0}),(0,J.hO)(a,b),b.defaultPrevented?l.current=!1:i.onClose()}}),onPointerDown:b=>{a.onPointerDown?.(b),l.current=!0},onPointerUp:(0,D.mK)(a.onPointerUp,a=>{l.current||a.currentTarget?.click()}),onKeyDown:(0,D.mK)(a.onKeyDown,a=>{let b=""!==j.searchRef.current;c||b&&" "===a.key||as.includes(a.key)&&(a.currentTarget.click(),a.preventDefault())})})});a_.displayName=aZ;var a0=e.forwardRef((a,b)=>{let{__scopeMenu:c,disabled:f=!1,textValue:g,...h}=a,i=aR(aZ,c),j=aE(c),k=e.useRef(null),l=(0,E.s)(b,k),[m,n]=e.useState(!1),[o,p]=e.useState("");return e.useEffect(()=>{let a=k.current;a&&p((a.textContent??"").trim())},[h.children]),(0,d.jsx)(ay.ItemSlot,{scope:c,disabled:f,textValue:g??o,children:(0,d.jsx)(am.q7,{asChild:!0,...j,focusable:!f,children:(0,d.jsx)(J.sG.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":f||void 0,"data-disabled":f?"":void 0,...h,ref:l,onPointerMove:(0,D.mK)(a.onPointerMove,bn(a=>{f?i.onItemLeave(a):(i.onItemEnter(a),a.defaultPrevented||a.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:(0,D.mK)(a.onPointerLeave,bn(a=>i.onItemLeave(a))),onFocus:(0,D.mK)(a.onFocus,()=>n(!0)),onBlur:(0,D.mK)(a.onBlur,()=>n(!1))})})})}),a1=e.forwardRef((a,b)=>{let{checked:c=!1,onCheckedChange:e,...f}=a;return(0,d.jsx)(a9,{scope:a.__scopeMenu,checked:c,children:(0,d.jsx)(a_,{role:"menuitemcheckbox","aria-checked":bl(c)?"mixed":c,...f,ref:b,"data-state":bm(c),onSelect:(0,D.mK)(f.onSelect,()=>e?.(!!bl(c)||!c),{checkForDefaultPrevented:!1})})})});a1.displayName="MenuCheckboxItem";var a2="MenuRadioGroup",[a3,a4]=aB(a2,{value:void 0,onValueChange:()=>{}}),a5=e.forwardRef((a,b)=>{let{value:c,onValueChange:e,...f}=a,g=(0,ap.c)(e);return(0,d.jsx)(a3,{scope:a.__scopeMenu,value:c,onValueChange:g,children:(0,d.jsx)(aX,{...f,ref:b})})});a5.displayName=a2;var a6="MenuRadioItem",a7=e.forwardRef((a,b)=>{let{value:c,...e}=a,f=a4(a6,a.__scopeMenu),g=c===f.value;return(0,d.jsx)(a9,{scope:a.__scopeMenu,checked:g,children:(0,d.jsx)(a_,{role:"menuitemradio","aria-checked":g,...e,ref:b,"data-state":bm(g),onSelect:(0,D.mK)(e.onSelect,()=>f.onValueChange?.(c),{checkForDefaultPrevented:!1})})})});a7.displayName=a6;var a8="MenuItemIndicator",[a9,ba]=aB(a8,{checked:!1}),bb=e.forwardRef((a,b)=>{let{__scopeMenu:c,forceMount:e,...f}=a,g=ba(a8,c);return(0,d.jsx)(al.C,{present:e||bl(g.checked)||!0===g.checked,children:(0,d.jsx)(J.sG.span,{...f,ref:b,"data-state":bm(g.checked)})})});bb.displayName=a8;var bc=e.forwardRef((a,b)=>{let{__scopeMenu:c,...e}=a;return(0,d.jsx)(J.sG.div,{role:"separator","aria-orientation":"horizontal",...e,ref:b})});bc.displayName="MenuSeparator";var bd=e.forwardRef((a,b)=>{let{__scopeMenu:c,...e}=a,f=aD(c);return(0,d.jsx)(aj.i3,{...f,...e,ref:b})});bd.displayName="MenuArrow";var[be,bf]=aB("MenuSub"),bg="MenuSubTrigger",bh=e.forwardRef((a,b)=>{let c=aG(bg,a.__scopeMenu),f=aI(bg,a.__scopeMenu),g=bf(bg,a.__scopeMenu),h=aR(bg,a.__scopeMenu),i=e.useRef(null),{pointerGraceTimerRef:j,onPointerGraceIntentChange:k}=h,l={__scopeMenu:a.__scopeMenu},m=e.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return e.useEffect(()=>m,[m]),e.useEffect(()=>{let a=j.current;return()=>{window.clearTimeout(a),k(null)}},[j,k]),(0,d.jsx)(aK,{asChild:!0,...l,children:(0,d.jsx)(a0,{id:g.triggerId,"aria-haspopup":"menu","aria-expanded":c.open,"aria-controls":g.contentId,"data-state":bk(c.open),...a,ref:(0,E.t)(b,g.onTriggerChange),onClick:b=>{a.onClick?.(b),a.disabled||b.defaultPrevented||(b.currentTarget.focus(),c.open||c.onOpenChange(!0))},onPointerMove:(0,D.mK)(a.onPointerMove,bn(b=>{h.onItemEnter(b),!b.defaultPrevented&&(a.disabled||c.open||i.current||(h.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{c.onOpenChange(!0),m()},100)))})),onPointerLeave:(0,D.mK)(a.onPointerLeave,bn(a=>{m();let b=c.content?.getBoundingClientRect();if(b){let d=c.content?.dataset.side,e="right"===d,f=b[e?"left":"right"],g=b[e?"right":"left"];h.onPointerGraceIntentChange({area:[{x:a.clientX+(e?-5:5),y:a.clientY},{x:f,y:b.top},{x:g,y:b.top},{x:g,y:b.bottom},{x:f,y:b.bottom}],side:d}),window.clearTimeout(j.current),j.current=window.setTimeout(()=>h.onPointerGraceIntentChange(null),300)}else{if(h.onTriggerLeave(a),a.defaultPrevented)return;h.onPointerGraceIntentChange(null)}})),onKeyDown:(0,D.mK)(a.onKeyDown,b=>{let d=""!==h.searchRef.current;a.disabled||d&&" "===b.key||av[f.dir].includes(b.key)&&(c.onOpenChange(!0),c.content?.focus(),b.preventDefault())})})})});bh.displayName=bg;var bi="MenuSubContent",bj=e.forwardRef((a,b)=>{let c=aN(aP,a.__scopeMenu),{forceMount:f=c.forceMount,...g}=a,h=aG(aP,a.__scopeMenu),i=aI(aP,a.__scopeMenu),j=bf(bi,a.__scopeMenu),k=e.useRef(null),l=(0,E.s)(b,k);return(0,d.jsx)(ay.Provider,{scope:a.__scopeMenu,children:(0,d.jsx)(al.C,{present:f||h.open,children:(0,d.jsx)(ay.Slot,{scope:a.__scopeMenu,children:(0,d.jsx)(aW,{id:j.contentId,"aria-labelledby":j.triggerId,...g,ref:l,align:"start",side:"rtl"===i.dir?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:a=>{i.isUsingKeyboardRef.current&&k.current?.focus(),a.preventDefault()},onCloseAutoFocus:a=>a.preventDefault(),onFocusOutside:(0,D.mK)(a.onFocusOutside,a=>{a.target!==j.trigger&&h.onOpenChange(!1)}),onEscapeKeyDown:(0,D.mK)(a.onEscapeKeyDown,a=>{i.onClose(),a.preventDefault()}),onKeyDown:(0,D.mK)(a.onKeyDown,a=>{let b=a.currentTarget.contains(a.target),c=aw[i.dir].includes(a.key);b&&c&&(h.onOpenChange(!1),j.trigger?.focus(),a.preventDefault())})})})})})});function bk(a){return a?"open":"closed"}function bl(a){return"indeterminate"===a}function bm(a){return bl(a)?"indeterminate":a?"checked":"unchecked"}function bn(a){return b=>"mouse"===b.pointerType?a(b):void 0}bj.displayName=bi;var bo="DropdownMenu",[bp,bq]=(0,F.A)(bo,[aC]),br=aC(),[bs,bt]=bp(bo),bu=a=>{let{__scopeDropdownMenu:b,children:c,dir:f,open:g,defaultOpen:h,onOpenChange:i,modal:j=!0}=a,k=br(b),l=e.useRef(null),[m,n]=(0,G.i)({prop:g,defaultProp:h??!1,onChange:i,caller:bo});return(0,d.jsx)(bs,{scope:b,triggerId:(0,ai.B)(),triggerRef:l,contentId:(0,ai.B)(),open:m,onOpenChange:n,onOpenToggle:e.useCallback(()=>n(a=>!a),[n]),modal:j,children:(0,d.jsx)(aJ,{...k,open:m,onOpenChange:n,dir:f,modal:j,children:c})})};bu.displayName=bo;var bv="DropdownMenuTrigger",bw=e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,disabled:e=!1,...f}=a,g=bt(bv,c),h=br(c);return(0,d.jsx)(aK,{asChild:!0,...h,children:(0,d.jsx)(J.sG.button,{type:"button",id:g.triggerId,"aria-haspopup":"menu","aria-expanded":g.open,"aria-controls":g.open?g.contentId:void 0,"data-state":g.open?"open":"closed","data-disabled":e?"":void 0,disabled:e,...f,ref:(0,E.t)(b,g.triggerRef),onPointerDown:(0,D.mK)(a.onPointerDown,a=>{!e&&0===a.button&&!1===a.ctrlKey&&(g.onOpenToggle(),g.open||a.preventDefault())}),onKeyDown:(0,D.mK)(a.onKeyDown,a=>{!e&&(["Enter"," "].includes(a.key)&&g.onOpenToggle(),"ArrowDown"===a.key&&g.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});bw.displayName=bv;var bx=a=>{let{__scopeDropdownMenu:b,...c}=a,e=br(b);return(0,d.jsx)(aO,{...e,...c})};bx.displayName="DropdownMenuPortal";var by="DropdownMenuContent",bz=e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...f}=a,g=bt(by,c),h=br(c),i=e.useRef(!1);return(0,d.jsx)(aS,{id:g.contentId,"aria-labelledby":g.triggerId,...h,...f,ref:b,onCloseAutoFocus:(0,D.mK)(a.onCloseAutoFocus,a=>{i.current||g.triggerRef.current?.focus(),i.current=!1,a.preventDefault()}),onInteractOutside:(0,D.mK)(a.onInteractOutside,a=>{let b=a.detail.originalEvent,c=0===b.button&&!0===b.ctrlKey,d=2===b.button||c;(!g.modal||d)&&(i.current=!0)}),style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});bz.displayName=by,e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...e}=a,f=br(c);return(0,d.jsx)(aX,{...f,...e,ref:b})}).displayName="DropdownMenuGroup";var bA=e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...e}=a,f=br(c);return(0,d.jsx)(aY,{...f,...e,ref:b})});bA.displayName="DropdownMenuLabel";var bB=e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...e}=a,f=br(c);return(0,d.jsx)(a_,{...f,...e,ref:b})});bB.displayName="DropdownMenuItem";var bC=e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...e}=a,f=br(c);return(0,d.jsx)(a1,{...f,...e,ref:b})});bC.displayName="DropdownMenuCheckboxItem",e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...e}=a,f=br(c);return(0,d.jsx)(a5,{...f,...e,ref:b})}).displayName="DropdownMenuRadioGroup";var bD=e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...e}=a,f=br(c);return(0,d.jsx)(a7,{...f,...e,ref:b})});bD.displayName="DropdownMenuRadioItem";var bE=e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...e}=a,f=br(c);return(0,d.jsx)(bb,{...f,...e,ref:b})});bE.displayName="DropdownMenuItemIndicator";var bF=e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...e}=a,f=br(c);return(0,d.jsx)(bc,{...f,...e,ref:b})});bF.displayName="DropdownMenuSeparator",e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...e}=a,f=br(c);return(0,d.jsx)(bd,{...f,...e,ref:b})}).displayName="DropdownMenuArrow";var bG=e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...e}=a,f=br(c);return(0,d.jsx)(bh,{...f,...e,ref:b})});bG.displayName="DropdownMenuSubTrigger";var bH=e.forwardRef((a,b)=>{let{__scopeDropdownMenu:c,...e}=a,f=br(c);return(0,d.jsx)(bj,{...f,...e,ref:b,style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});bH.displayName="DropdownMenuSubContent";var bI=c(59405),bJ=c(71613);let bK=(0,V.A)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.forwardRef(({className:a,inset:b,children:c,...e},f)=>(0,d.jsxs)(bG,{ref:f,className:(0,s.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",b&&"pl-8",a),...e,children:[c,(0,d.jsx)(bI.A,{className:"ml-auto h-4 w-4"})]})).displayName=bG.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(bH,{ref:c,className:(0,s.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...b})).displayName=bH.displayName;let bL=e.forwardRef(({className:a,sideOffset:b=4,...c},e)=>(0,d.jsx)(bx,{children:(0,d.jsx)(bz,{ref:e,sideOffset:b,className:(0,s.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...c})}));bL.displayName=bz.displayName;let bM=e.forwardRef(({className:a,inset:b,...c},e)=>(0,d.jsx)(bB,{ref:e,className:(0,s.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",b&&"pl-8",a),...c}));bM.displayName=bB.displayName,e.forwardRef(({className:a,children:b,checked:c,...e},f)=>(0,d.jsxs)(bC,{ref:f,className:(0,s.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:c,...e,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(bE,{children:(0,d.jsx)(bJ.A,{className:"h-4 w-4"})})}),b]})).displayName=bC.displayName,e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(bD,{ref:e,className:(0,s.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(bE,{children:(0,d.jsx)(bK,{className:"h-2 w-2 fill-current"})})}),b]})).displayName=bD.displayName,e.forwardRef(({className:a,inset:b,...c},e)=>(0,d.jsx)(bA,{ref:e,className:(0,s.cn)("px-2 py-1.5 text-sm font-semibold",b&&"pl-8",a),...c})).displayName=bA.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(bF,{ref:c,className:(0,s.cn)("-mx-1 my-1 h-px bg-muted",a),...b})).displayName=bF.displayName;let bN=(0,V.A)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var bO=c(78460);let bP=(0,V.A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),bQ=(0,V.A)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),bR=(0,V.A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function bS({profile:a,onStampChange:b,onEdit:c,onStampSet:f}){let[g,j]=(0,e.useState)(!1),[o,p]=(0,e.useState)(!1),[q,r]=(0,e.useState)(a.real_name??""),[s,t]=(0,e.useState)(a.ticket_number??""),[u,v]=(0,e.useState)(a.last_visit_date?a.last_visit_date.slice(0,10):""),[w,x]=(0,e.useState)(a.view_mode??""),[y,z]=(0,e.useState)(a.next_visit_date??""),[A,B]=(0,e.useState)(a.next_memo??""),[C,D]=(0,e.useState)(String(a.stamp_count)),E=b=>{j(b),b&&(r(a.real_name??""),t(a.ticket_number??""),v(a.last_visit_date?a.last_visit_date.slice(0,10):""),x(a.view_mode??""),z(a.next_visit_date??""),B(a.next_memo??""))},F=!!y&&i(y),G=A.length>200,H=b=>{p(b),b&&D(String(a.stamp_count))};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(bu,{children:[(0,d.jsx)(bw,{asChild:!0,children:(0,d.jsx)(k.$,{size:"icon",variant:"ghost","aria-label":"その他の操作",children:(0,d.jsx)(bN,{className:"h-5 w-5"})})}),(0,d.jsxs)(bL,{align:"end",children:[(0,d.jsxs)(bM,{onClick:()=>E(!0),children:[(0,d.jsx)(bO.A,{className:"h-4 w-4 mr-2"}),"編集"]}),(0,d.jsxs)(bM,{onClick:()=>b(-1),disabled:a.stamp_count<=0,children:[(0,d.jsx)(bP,{className:"h-4 w-4 mr-2"}),"-1 スタンプ減らす"]}),(0,d.jsxs)(bM,{onClick:()=>H(!0),children:[(0,d.jsx)(bQ,{className:"h-4 w-4 mr-2"}),"数値入力"]})]})]}),(0,d.jsx)(n.lG,{open:g,onOpenChange:E,children:(0,d.jsxs)(n.Cf,{className:"max-w-md sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,d.jsx)(n.c7,{children:(0,d.jsx)(n.L3,{children:"患者情報を編集"})}),(0,d.jsxs)("div",{className:"grid gap-6 py-4",children:[(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("h3",{className:"text-sm font-semibold text-slate-700",children:"基本情報"}),(0,d.jsxs)("div",{className:"grid gap-4",children:[(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsx)(m.J,{htmlFor:"mobile-real-name",children:"本名（管理画面専用）"}),(0,d.jsx)(l.p,{id:"mobile-real-name",value:q,onChange:a=>r(a.target.value),placeholder:"例: 山田 太郎"})]}),(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsx)(m.J,{htmlFor:"mobile-ticket-number",children:"診察券番号"}),(0,d.jsx)(l.p,{id:"mobile-ticket-number",value:s,onChange:a=>t(a.target.value),placeholder:"例: 12345"})]}),(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsx)(m.J,{htmlFor:"mobile-last-visit-date",children:"最終来院日"}),(0,d.jsx)(l.p,{id:"mobile-last-visit-date",type:"date",value:u,onChange:a=>v(a.target.value)})]}),(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsx)(m.J,{htmlFor:"mobile-view-mode",children:"表示モード"}),(0,d.jsxs)("select",{id:"mobile-view-mode",value:w,onChange:a=>x(a.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[(0,d.jsx)("option",{value:"",children:"未設定"}),(0,d.jsx)("option",{value:"adult",children:"大人"}),(0,d.jsx)("option",{value:"kids",children:"キッズ"})]})]})]})]}),(0,d.jsx)(ac,{}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("h3",{className:"text-sm font-semibold text-slate-700",children:"次回来院予定"}),(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsx)(m.J,{htmlFor:"mobile-next-visit-date",children:"次回来院予定日"}),(0,d.jsx)(l.p,{id:"mobile-next-visit-date",type:"date",value:y,onChange:a=>z(a.target.value)}),F&&(0,d.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-amber-600",children:[(0,d.jsx)(bR,{className:"h-3.5 w-3.5"}),"過去の日付が設定されています"]})]}),(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(m.J,{htmlFor:"mobile-next-memo",children:"次回メモ"}),(0,d.jsxs)("div",{className:"flex gap-1",children:[(0,d.jsx)(k.$,{type:"button",variant:"outline",size:"sm",className:"h-6 px-2 text-xs",onClick:()=>B("次回は歯石除去を行います。よろしくお願いします。"),children:"歯石除去"}),(0,d.jsx)(k.$,{type:"button",variant:"outline",size:"sm",className:"h-6 px-2 text-xs",onClick:()=>B("次回は定期検診です。お待ちしております。"),children:"定期検診"})]})]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(Y,{id:"mobile-next-memo",value:A,onChange:a=>B(a.target.value),placeholder:"次回来院時のメッセージを入力（例: 歯石除去を行います）",rows:4,maxLength:200,className:"resize-none pr-16"}),(0,d.jsxs)("span",{className:`absolute bottom-2 right-2 text-xs ${G?"text-red-600 font-semibold":"text-slate-400"}`,children:[A.length,"/200"]})]}),G&&(0,d.jsxs)("p",{className:"text-xs text-red-600",children:["200文字を超えています（現在: ",A.length,"文字）"]})]}),(y||A)&&(0,d.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-4 text-sm",children:[(0,d.jsxs)("div",{className:"mb-2 flex items-center gap-1.5 text-xs font-medium text-slate-500",children:[(0,d.jsx)("span",{children:"\uD83D\uDCF1"}),"患者側プレビュー"]}),(0,d.jsxs)("div",{className:"text-slate-700 space-y-1",children:[y&&(0,d.jsxs)("div",{className:"font-semibold",children:["次回来院予定: ",h(y)]}),A&&(0,d.jsx)("div",{className:"whitespace-pre-wrap",children:A})]})]})]})]}),(0,d.jsxs)(n.Es,{className:"flex-row justify-end gap-2",children:[(0,d.jsx)(k.$,{variant:"outline",size:"sm",onClick:()=>j(!1),children:"キャンセル"}),(0,d.jsx)(k.$,{size:"sm",onClick:()=>{c({real_name:q.trim()||null,ticket_number:s.trim()||null,last_visit_date:u.trim()||null,view_mode:w.trim()||null,next_visit_date:y.trim()||null,next_memo:A.trim()||null}),j(!1)},disabled:G,children:"保存"})]})]})}),(0,d.jsx)(n.lG,{open:o,onOpenChange:H,children:(0,d.jsxs)(n.Cf,{children:[(0,d.jsx)(n.c7,{children:(0,d.jsx)(n.L3,{children:"スタンプ数を直接入力"})}),(0,d.jsx)("div",{className:"grid gap-4 py-4",children:(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsxs)(m.J,{htmlFor:"mobile-stamp-count",children:[a.display_name||a.id," のスタンプ数（0〜999）"]}),(0,d.jsx)(l.p,{id:"mobile-stamp-count",type:"number",min:0,max:999,value:C,onChange:a=>D(a.target.value)})]})}),(0,d.jsxs)(n.Es,{children:[(0,d.jsx)(k.$,{variant:"outline",onClick:()=>p(!1),children:"キャンセル"}),(0,d.jsx)(k.$,{onClick:()=>{let a=parseInt(C,10);!Number.isInteger(a)||a<0||a>999||(f(a),p(!1))},children:"保存"})]})]})})]})}function bT({profile:a,onStampChange:b,onEdit:c,onStampSet:e,onMessage:f,onViewModeToggle:h}){return(0,d.jsxs)("div",{className:"bg-white rounded-lg border shadow-sm p-4 space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h3",{className:"font-semibold text-lg truncate",children:a.display_name||"—"}),a.real_name&&(0,d.jsxs)("p",{className:"text-sm font-medium text-slate-700",children:["本名: ",a.real_name]}),(0,d.jsxs)("p",{className:"text-sm text-muted-foreground",children:["診察券: ",a.ticket_number||"—"]})]}),(0,d.jsx)(j.E,{variant:"secondary",className:"text-lg font-bold px-3 py-1 ml-3 shrink-0",children:a.stamp_count})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"最終来院:"}),(0,d.jsx)("br",{}),(0,d.jsx)("span",{className:"font-medium",children:a.last_visit_date?(0,g.B)(a.last_visit_date):"—"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"最新ログイン:"}),(0,d.jsx)("br",{}),(0,d.jsx)("span",{className:"font-medium",children:(0,g.B)(a.updated_at)})]})]}),(0,d.jsxs)("div",{className:"text-sm",children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"公式アカ: "}),!0===a.is_line_friend?(0,d.jsx)("span",{className:"text-emerald-600 font-medium",children:"○ 済"}):(0,d.jsx)("span",{className:"text-muted-foreground",children:"—"})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2 pt-1",children:[(0,d.jsx)(U,{checked:"kids"===a.view_mode,onCheckedChange:h,"aria-label":`${a.display_name||a.id}の表示モードを切り替え`}),(0,d.jsx)("span",{className:"text-sm text-muted-foreground",children:"kids"===a.view_mode?"キッズモード":"大人モード"})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2 pt-2",children:[(0,d.jsxs)(k.$,{size:"default",className:"flex-1 bg-indigo-600 hover:bg-indigo-700 text-white border-0 shadow-sm",onClick:f,children:[(0,d.jsx)(W,{className:"h-4 w-4 mr-1"}),"メッセージ"]}),(0,d.jsxs)(k.$,{size:"lg",className:"bg-emerald-600 hover:bg-emerald-700 text-white px-6 shadow-sm",onClick:()=>b(1),children:[(0,d.jsx)(X,{className:"h-5 w-5 mr-1"}),"+1"]}),(0,d.jsx)(bS,{profile:a,onStampChange:b,onEdit:c,onStampSet:e})]})]})}function bU({patients:a,onStampChange:b,onEdit:c,onStampSet:e,onMessage:f,onViewModeToggle:g}){return 0===a.length?(0,d.jsx)("div",{className:"text-center text-muted-foreground py-8 bg-white rounded-lg border",children:"該当する患者がいません。"}):(0,d.jsx)("div",{className:"space-y-3",children:a.map(a=>(0,d.jsx)(bT,{profile:a,onStampChange:c=>b(a.id,c),onEdit:b=>c(a.id,b),onStampSet:b=>e(a.id,b),onMessage:()=>f(a),onViewModeToggle:()=>g(a.id,a.view_mode)},a.id))})}var bV=c(83047),bW=c(65893),bX=c(88285),bY=c(14263),bZ=c(92500);let b$=a=>fetch(a).then(a=>a.json());function b_({representativeProfile:a,open:b,onOpenChange:c,onSuccess:g}){let[h,i]=(0,e.useState)(`${a.display_name||"ユーザー"}の家族`),[o,p]=(0,e.useState)(""),[q,s]=(0,e.useState)([]),[t,u]=(0,e.useState)(!1),{data:v=[]}=(0,f.Ay)("/api/profiles",b$),w=v.filter(b=>{if(b.id===a.id||q.some(a=>a.profile.id===b.id)||!o.trim())return!1;let c=o.toLowerCase();return b.display_name?.toLowerCase().includes(c)||b.ticket_number?.toLowerCase().includes(c)});async function x(){if(!h.trim())return void alert("家族名を入力してください");u(!0);try{let b=[a.id,...q.map(a=>a.profile.id)],d=await fetch("/api/families",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({family_name:h.trim(),representative_user_id:a.id,member_ids:b})});if(!d.ok){let a=await d.json();throw Error(a.error||"家族の作成に失敗しました")}g(),c(!1),i(`${a.display_name||"ユーザー"}の家族`),p(""),s([])}catch(a){console.error("家族作成エラー:",a),alert(a instanceof Error?a.message:"家族の作成に失敗しました。もう一度お試しください。")}finally{u(!1)}}return(0,d.jsx)(n.lG,{open:b,onOpenChange:c,children:(0,d.jsxs)(n.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,d.jsx)(n.c7,{children:(0,d.jsxs)(n.L3,{className:"flex items-center gap-2",children:[(0,d.jsx)(bW.A,{className:"h-5 w-5"}),"家族を作成 - ",a.display_name||"ユーザー"]})}),(0,d.jsxs)("div",{className:"space-y-6 py-4",children:[(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(m.J,{htmlFor:"family-name",children:"家族名"}),(0,d.jsx)(l.p,{id:"family-name",value:h,onChange:a=>i(a.target.value),placeholder:"例: 横山浩紀の家族"})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(m.J,{children:"代表者"}),(0,d.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg border",children:[(0,d.jsx)(j.E,{children:"保護者"}),(0,d.jsx)("span",{className:"font-medium",children:a.display_name||"—"}),(0,d.jsxs)("span",{className:"text-xs text-muted-foreground",children:["診察券: ",a.ticket_number||"—"]})]})]}),(0,d.jsx)("div",{className:"border-t pt-4",children:(0,d.jsx)(m.J,{className:"text-base font-semibold",children:"家族メンバーを追加"})}),(0,d.jsx)("div",{className:"space-y-2",children:(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(bX.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,d.jsx)(l.p,{value:o,onChange:a=>p(a.target.value),placeholder:"名前または診察券番号で検索...",className:"pl-10"})]})}),o.trim()&&(0,d.jsx)("div",{className:"space-y-2 max-h-[200px] overflow-y-auto border rounded-lg p-2",children:0===w.length?(0,d.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"該当する患者がいません"}):w.map(a=>{let b=q.some(b=>b.profile.id===a.id);return(0,d.jsxs)("div",{className:"flex items-center gap-3 p-2 hover:bg-slate-50 rounded cursor-pointer",onClick:()=>{q.find(b=>b.profile.id===a.id)?s(q.filter(b=>b.profile.id!==a.id)):s([...q,{profile:a,role:"child"}])},children:[(0,d.jsx)(bZ.S,{checked:b}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("span",{className:"font-medium",children:a.display_name||"—"}),(0,d.jsxs)("span",{className:"text-xs text-muted-foreground ml-2",children:["(",a.ticket_number||"診察券なし",")"]})]})]},a.id)})}),q.length>0&&(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(m.J,{className:"text-sm font-semibold",children:"選択されたメンバー"}),(0,d.jsx)("div",{className:"space-y-2",children:q.map(a=>(0,d.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg border",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,d.jsx)("span",{className:"font-medium",children:a.profile.display_name||"—"}),(0,d.jsx)("span",{className:"text-xs text-muted-foreground",children:a.profile.ticket_number||"—"})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)(bV.l6,{value:a.role,onValueChange:b=>{var c;return c=a.profile.id,void s(q.map(a=>a.profile.id===c?{...a,role:b}:a))},children:[(0,d.jsx)(bV.bq,{className:"w-[120px]",children:(0,d.jsx)(bV.yv,{})}),(0,d.jsxs)(bV.gC,{children:[(0,d.jsx)(bV.eb,{value:"parent",children:"保護者"}),(0,d.jsx)(bV.eb,{value:"child",children:"子ども"})]})]}),(0,d.jsx)(k.$,{size:"sm",variant:"ghost",onClick:()=>{var b;return b=a.profile.id,void s(q.filter(a=>a.profile.id!==b))},children:(0,d.jsx)(r.A,{className:"h-4 w-4"})})]})]},a.profile.id))})]})]}),(0,d.jsxs)(n.Es,{className:"gap-2",children:[(0,d.jsx)(k.$,{variant:"outline",onClick:()=>c(!1),disabled:t,children:"キャンセル"}),(0,d.jsx)(k.$,{onClick:x,disabled:t||!h.trim(),children:t?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(bY.A,{className:"h-4 w-4 mr-2 animate-spin"}),"作成中..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(bW.A,{className:"h-4 w-4 mr-2"}),"家族を作成"]})})]})]})})}let b0=a=>fetch(a).then(a=>a.json());function b1(){let{data:a=[],error:b,mutate:c,isLoading:i}=(0,f.Ay)("/api/profiles",b0),{data:m=[]}=(0,f.Ay)("/api/families",b0),[n,p]=(0,e.useState)(""),[q,r]=(0,e.useState)(null),[s,t]=(0,e.useState)(null),[u,v]=(0,e.useState)({key:"updated_at",direction:"desc"}),w=(0,e.useMemo)(()=>{if(!n.trim())return a;let b=n.trim().toLowerCase();return a.filter(a=>a.display_name?.toLowerCase().includes(b)||a.real_name?.toLowerCase().includes(b)||a.ticket_number?.toLowerCase().includes(b))},[a,n]),x=(0,e.useMemo)(()=>{let a=[...w];return a.sort((a,b)=>{let c="asc"===u.direction?1:-1,d=a=>{switch(u.key){case"ticket_number":return(a.ticket_number??"").toLowerCase();case"stamp_count":return a.stamp_count;case"last_visit_date":return a.last_visit_date?Date.parse(a.last_visit_date):0;case"updated_at":return a.updated_at?Date.parse(a.updated_at):0;case"is_line_friend":return+!!a.is_line_friend;case"view_mode":return(a.view_mode??"").toLowerCase();case"family_category":return F(a)}},e=d(a),f=d(b);return e<f?-1*c:e>f?+c:0}),a},[w,u]);function y(a){v(b=>b.key===a?{key:a,direction:"asc"===b.direction?"desc":"asc"}:{key:a,direction:"asc"})}function z(a){return u.key!==a?(0,d.jsx)("span",{className:"ml-1 text-xs text-slate-400",children:"⇅"}):(0,d.jsx)("span",{className:"ml-1 text-xs text-sky-600 font-semibold",children:"asc"===u.direction?"↑":"↓"})}async function A(b,d){let e=await fetch(`/api/profiles/${b}/stamp`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({delta:d})});if(!e.ok)return;let f=await e.json();c(a.map(a=>a.id===b?f:a),{revalidate:!1})}async function B(b,d){let e=await fetch(`/api/profiles/${b}/stamp-set`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({stamp_count:d})});if(!e.ok)return;let f=await e.json();c(a.map(a=>a.id===b?f:a),{revalidate:!1})}async function D(b,d){let e=await fetch(`/api/profiles/${b}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!e.ok)return;let f=await e.json();c(a.map(a=>a.id===b?f:a),{revalidate:!1})}async function E(a,b){await D(a,{view_mode:"kids"===b?"adult":"kids"})}function F(a){if(!a.family_id||!a.family_role)return"なし";let b=m.find(b=>b.family_id===a.family_id);return 1===(b?.member_count||0)?"なし":"parent"===a.family_role?"保護者":a.line_user_id?"子（スマホあり）":"子（スマホなし）"}return b?(0,d.jsx)("p",{className:"text-destructive",children:"一覧の取得に失敗しました。しばらくしてから再試行してください。"}):i?(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[(0,d.jsx)(bY.A,{className:"h-12 w-12 text-sky-500 animate-spin"}),(0,d.jsx)("p",{className:"text-muted-foreground text-sm",children:"患者データを読み込んでいます..."})]}):(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,d.jsx)(l.p,{placeholder:"名前または診察券番号で検索",value:n,onChange:a=>p(a.target.value),className:"w-full lg:max-w-sm bg-white/80"}),(0,d.jsx)("span",{className:"hidden text-xs text-muted-foreground md:inline",children:"Supabase の `profiles` テーブルとリアルタイム連携しています。"})]}),(0,d.jsx)("div",{className:"hidden lg:block overflow-hidden rounded-xl border bg-white/90 shadow-sm",children:(0,d.jsxs)(o.XI,{children:[(0,d.jsx)(o.A0,{children:(0,d.jsxs)(o.Hj,{className:"bg-slate-50/80",children:[(0,d.jsx)(o.nd,{children:"LINE表示名"}),(0,d.jsx)(o.nd,{children:"本名"}),(0,d.jsx)(o.nd,{onClick:()=>y("family_category"),className:"cursor-pointer select-none w-[140px]",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["区分",z("family_category")]})}),(0,d.jsx)(o.nd,{onClick:()=>y("ticket_number"),className:"cursor-pointer select-none",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["診察券番号",z("ticket_number")]})}),(0,d.jsx)(o.nd,{onClick:()=>y("stamp_count"),className:"cursor-pointer select-none",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["スタンプ数",z("stamp_count")]})}),(0,d.jsx)(o.nd,{onClick:()=>y("last_visit_date"),className:"cursor-pointer select-none",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["最終来院",z("last_visit_date")]})}),(0,d.jsx)(o.nd,{onClick:()=>y("updated_at"),className:"cursor-pointer select-none",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["最新ログイン",z("updated_at")]})}),(0,d.jsx)(o.nd,{onClick:()=>y("is_line_friend"),className:"cursor-pointer select-none",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["公式アカ友だち",z("is_line_friend")]})}),(0,d.jsx)(o.nd,{onClick:()=>y("view_mode"),className:"cursor-pointer select-none",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["表示モード",z("view_mode")]})}),(0,d.jsx)(o.nd,{children:"次回来院予定日"}),(0,d.jsx)(o.nd,{className:"w-[200px]",children:"次回メモ"}),(0,d.jsx)(o.nd,{className:"w-[300px]",children:"操作"})]})}),(0,d.jsx)(o.BF,{children:0===w.length?(0,d.jsx)(o.Hj,{children:(0,d.jsx)(o.nA,{colSpan:12,className:"text-center text-muted-foreground py-8",children:0===a.length?"患者データがありません。":"該当する患者がいません。"})}):x.map(a=>(0,d.jsxs)(o.Hj,{className:"hover:bg-slate-50/80 transition-colors",children:[(0,d.jsx)(o.nA,{className:"font-medium",children:a.display_name||"—"}),(0,d.jsx)(o.nA,{className:"font-medium text-slate-700",children:a.real_name||"—"}),(0,d.jsx)(o.nA,{className:"text-sm whitespace-nowrap",children:F(a)}),(0,d.jsx)(o.nA,{className:"text-muted-foreground",children:a.ticket_number||"—"}),(0,d.jsx)(o.nA,{children:(0,d.jsx)(j.E,{variant:"secondary",className:"font-semibold",children:a.stamp_count})}),(0,d.jsx)(o.nA,{className:"text-muted-foreground text-xs whitespace-nowrap",children:a.last_visit_date?(0,g.B)(a.last_visit_date):"—"}),(0,d.jsx)(o.nA,{className:"text-muted-foreground text-xs whitespace-nowrap",title:"最新ログイン",children:(0,g.B)(a.updated_at)}),(0,d.jsx)(o.nA,{className:"text-center",children:!0===a.is_line_friend?(0,d.jsx)("span",{className:"text-emerald-600 font-medium",title:"公式アカウントの友だち登録済み",children:"〇 済"}):(0,d.jsx)("span",{className:"text-muted-foreground",children:"—"})}),(0,d.jsx)(o.nA,{children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(U,{checked:"kids"===a.view_mode,onCheckedChange:()=>E(a.id,a.view_mode),"aria-label":`${a.display_name||a.id}の表示モードを切り替え`}),(0,d.jsx)("span",{className:"text-sm text-muted-foreground min-w-[40px]",children:"kids"===a.view_mode?"キッズ":"大人"})]})}),(0,d.jsx)(o.nA,{className:"text-muted-foreground text-xs whitespace-nowrap align-top",children:a.next_visit_date?h(a.next_visit_date):"—"}),(0,d.jsx)(o.nA,{className:"text-muted-foreground text-[11px] max-w-[200px] align-top",children:(0,d.jsx)("div",{className:"whitespace-pre-wrap break-words leading-relaxed",children:a.next_memo||"—"})}),(0,d.jsx)(o.nA,{children:(0,d.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,d.jsx)(b2,{profile:a,onSave:b=>D(a.id,b)}),(0,d.jsxs)(k.$,{size:"sm",variant:"outline",className:"border-rose-300 text-rose-700 hover:bg-rose-50 hover:border-rose-400 hover:text-rose-800",onClick:()=>A(a.id,-1),disabled:a.stamp_count<=0,children:[(0,d.jsx)(bP,{className:"h-3.5 w-3.5"})," -1"]}),(0,d.jsxs)(k.$,{size:"sm",variant:"outline",className:"border-emerald-300 text-emerald-700 hover:bg-emerald-50 hover:border-emerald-400 hover:text-emerald-800",onClick:()=>A(a.id,1),children:[(0,d.jsx)(X,{className:"h-3.5 w-3.5"})," +1"]}),(0,d.jsx)(b3,{profile:a,onSave:b=>B(a.id,b)}),(0,d.jsxs)(k.$,{size:"sm",variant:"outline",className:"border-emerald-300 text-emerald-700 hover:bg-emerald-50 hover:border-emerald-400",onClick:()=>t(a),children:[(0,d.jsx)(bW.A,{className:"h-3.5 w-3.5"}),"家族作成"]}),(0,d.jsxs)(k.$,{size:"sm",className:"bg-indigo-600 hover:bg-indigo-700 text-white border-0 shadow-sm",onClick:()=>r(a),children:[(0,d.jsx)(W,{className:"h-3.5 w-3.5"}),"メッセージ"]})]})})]},a.id))})]})}),(0,d.jsx)("div",{className:"block lg:hidden",children:(0,d.jsx)(bU,{patients:x,onStampChange:A,onEdit:D,onStampSet:B,onMessage:r,onViewModeToggle:E})}),q&&(0,d.jsx)(C,{profile:q,open:!!q,onOpenChange:a=>!a&&r(null)}),s&&(0,d.jsx)(b_,{representativeProfile:s,open:!!s,onOpenChange:a=>!a&&t(null),onSuccess:()=>c()})]})}function b2({profile:a,onSave:b}){let[c,f]=(0,e.useState)(!1),[g,j]=(0,e.useState)(a.real_name??""),[o,p]=(0,e.useState)(a.ticket_number??""),[q,r]=(0,e.useState)(a.last_visit_date?a.last_visit_date.slice(0,10):""),[s,t]=(0,e.useState)(a.view_mode??""),[u,v]=(0,e.useState)(a.next_visit_date??""),[w,x]=(0,e.useState)(a.next_memo??""),y=!!u&&i(u),z=w.length>200;return(0,d.jsxs)(n.lG,{open:c,onOpenChange:b=>{f(b),b&&(j(a.real_name??""),p(a.ticket_number??""),r(a.last_visit_date?a.last_visit_date.slice(0,10):""),t(a.view_mode??""),v(a.next_visit_date??""),x(a.next_memo??""))},children:[(0,d.jsx)(n.zM,{asChild:!0,children:(0,d.jsxs)(k.$,{variant:"outline",size:"sm",className:"border-amber-300 text-amber-800 hover:bg-amber-50 hover:border-amber-400",children:[(0,d.jsx)(bO.A,{className:"h-3.5 w-3.5"}),"編集"]})}),(0,d.jsxs)(n.Cf,{className:"max-w-md sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,d.jsx)(n.c7,{children:(0,d.jsx)(n.L3,{children:"患者情報を編集"})}),(0,d.jsxs)("div",{className:"grid gap-6 py-4",children:[(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("h3",{className:"text-sm font-semibold text-slate-700",children:"基本情報"}),(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsx)(m.J,{htmlFor:"real-name",children:"本名（管理画面専用）"}),(0,d.jsx)(l.p,{id:"real-name",value:g,onChange:a=>j(a.target.value),placeholder:"例: 山田 太郎"})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsx)(m.J,{htmlFor:"ticket-number",children:"診察券番号"}),(0,d.jsx)(l.p,{id:"ticket-number",value:o,onChange:a=>p(a.target.value),placeholder:"例: 12345"})]}),(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsx)(m.J,{htmlFor:"last-visit-date",children:"最終来院日"}),(0,d.jsx)(l.p,{id:"last-visit-date",type:"date",value:q,onChange:a=>r(a.target.value)})]})]}),(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsx)(m.J,{htmlFor:"view-mode",children:"表示モード"}),(0,d.jsxs)("select",{id:"view-mode",value:s,onChange:a=>t(a.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[(0,d.jsx)("option",{value:"",children:"未設定"}),(0,d.jsx)("option",{value:"adult",children:"大人"}),(0,d.jsx)("option",{value:"kids",children:"キッズ"})]})]})]}),(0,d.jsx)(ac,{}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("h3",{className:"text-sm font-semibold text-slate-700",children:"次回来院予定"}),(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsx)(m.J,{htmlFor:"next-visit-date",children:"次回来院予定日"}),(0,d.jsx)(l.p,{id:"next-visit-date",type:"date",value:u,onChange:a=>v(a.target.value)}),y&&(0,d.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-amber-600",children:[(0,d.jsx)(bR,{className:"h-3.5 w-3.5"}),"過去の日付が設定されています"]})]}),(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(m.J,{htmlFor:"next-memo",children:"次回メモ"}),(0,d.jsxs)("div",{className:"flex gap-1",children:[(0,d.jsx)(k.$,{type:"button",variant:"outline",size:"sm",className:"h-6 px-2 text-xs",onClick:()=>x("次回は歯石除去を行います。よろしくお願いします。"),children:"歯石除去"}),(0,d.jsx)(k.$,{type:"button",variant:"outline",size:"sm",className:"h-6 px-2 text-xs",onClick:()=>x("次回は定期検診です。お待ちしております。"),children:"定期検診"})]})]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(Y,{id:"next-memo",value:w,onChange:a=>x(a.target.value),placeholder:"次回来院時のメッセージを入力（例: 歯石除去を行います）",rows:4,maxLength:200,className:"resize-none pr-16"}),(0,d.jsxs)("span",{className:`absolute bottom-2 right-2 text-xs ${z?"text-red-600 font-semibold":"text-slate-400"}`,children:[w.length,"/200"]})]}),z&&(0,d.jsxs)("p",{className:"text-xs text-red-600",children:["200文字を超えています（現在: ",w.length,"文字）"]})]}),(u||w)&&(0,d.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-4 text-sm",children:[(0,d.jsxs)("div",{className:"mb-2 flex items-center gap-1.5 text-xs font-medium text-slate-500",children:[(0,d.jsx)("span",{children:"\uD83D\uDCF1"}),"患者側プレビュー"]}),(0,d.jsxs)("div",{className:"text-slate-700 space-y-1",children:[u&&(0,d.jsxs)("div",{className:"font-semibold",children:["次回来院予定: ",h(u)]}),w&&(0,d.jsx)("div",{className:"whitespace-pre-wrap",children:w})]})]})]})]}),(0,d.jsxs)(n.Es,{className:"flex-row justify-end gap-2",children:[(0,d.jsx)(k.$,{variant:"outline",size:"sm",onClick:()=>f(!1),children:"キャンセル"}),(0,d.jsx)(k.$,{size:"sm",onClick:()=>{b({real_name:g.trim()||null,ticket_number:o.trim()||null,last_visit_date:q.trim()||null,view_mode:s.trim()||null,next_visit_date:u.trim()||null,next_memo:w.trim()||null}),f(!1)},disabled:z,children:"保存"})]})]})]})}function b3({profile:a,onSave:b}){let[c,f]=(0,e.useState)(!1),[g,h]=(0,e.useState)(String(a.stamp_count));return(0,d.jsxs)(n.lG,{open:c,onOpenChange:b=>{f(b),b&&h(String(a.stamp_count))},children:[(0,d.jsx)(n.zM,{asChild:!0,children:(0,d.jsxs)(k.$,{variant:"outline",size:"sm",className:"border-slate-300 text-slate-700 hover:bg-slate-100 hover:border-slate-400",children:[(0,d.jsx)(bQ,{className:"h-3.5 w-3.5"}),"数値"]})}),(0,d.jsxs)(n.Cf,{children:[(0,d.jsx)(n.c7,{children:(0,d.jsx)(n.L3,{children:"スタンプ数を直接入力"})}),(0,d.jsx)("div",{className:"grid gap-4 py-4",children:(0,d.jsxs)("div",{className:"grid gap-2",children:[(0,d.jsxs)(m.J,{htmlFor:"stamp-count",children:[a.display_name||a.id," のスタンプ数（0〜999）"]}),(0,d.jsx)(l.p,{id:"stamp-count",type:"number",min:0,max:999,value:g,onChange:a=>h(a.target.value)})]})}),(0,d.jsxs)(n.Es,{children:[(0,d.jsx)(k.$,{variant:"outline",onClick:()=>f(!1),children:"キャンセル"}),(0,d.jsx)(k.$,{onClick:()=>{let a=parseInt(g,10);!Number.isInteger(a)||a<0||a>999||(b(a),f(!1))},children:"保存"})]})]})]})}},17677:(a,b,c)=>{"use strict";c.d(b,{A0:()=>h,BF:()=>i,Hj:()=>j,XI:()=>g,nA:()=>l,nd:()=>k});var d=c(21124),e=c(38301),f=c(15514);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{className:"relative w-full overflow-auto",children:(0,d.jsx)("table",{ref:c,className:(0,f.cn)("w-full caption-bottom text-sm",a),...b})}));g.displayName="Table";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("thead",{ref:c,className:(0,f.cn)("[&_tr]:border-b",a),...b}));h.displayName="TableHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("tbody",{ref:c,className:(0,f.cn)("[&_tr:last-child]:border-0",a),...b}));i.displayName="TableBody";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("tr",{ref:c,className:(0,f.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...b}));j.displayName="TableRow";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("th",{ref:c,className:(0,f.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...b}));k.displayName="TableHead";let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("td",{ref:c,className:(0,f.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...b}));l.displayName="TableCell"},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},22544:(a,b,c)=>{"use strict";c.d(b,{E:()=>h});var d=c(21124);c(38301);var e=c(26691),f=c(15514);let g=(0,e.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function h({className:a,variant:b,...c}){return(0,d.jsx)("div",{className:(0,f.cn)(g({variant:b}),a),...c})}},25122:(a,b,c)=>{"use strict";c.d(b,{Mz:()=>a1,i3:()=>a3,UC:()=>a2,bL:()=>a0,Bk:()=>aM});var d=c(38301);let e=["top","right","bottom","left"],f=Math.min,g=Math.max,h=Math.round,i=Math.floor,j=a=>({x:a,y:a}),k={left:"right",right:"left",bottom:"top",top:"bottom"},l={start:"end",end:"start"};function m(a,b){return"function"==typeof a?a(b):a}function n(a){return a.split("-")[0]}function o(a){return a.split("-")[1]}function p(a){return"x"===a?"y":"x"}function q(a){return"y"===a?"height":"width"}let r=new Set(["top","bottom"]);function s(a){return r.has(n(a))?"y":"x"}function t(a){return a.replace(/start|end/g,a=>l[a])}let u=["left","right"],v=["right","left"],w=["top","bottom"],x=["bottom","top"];function y(a){return a.replace(/left|right|bottom|top/g,a=>k[a])}function z(a){return"number"!=typeof a?{top:0,right:0,bottom:0,left:0,...a}:{top:a,right:a,bottom:a,left:a}}function A(a){let{x:b,y:c,width:d,height:e}=a;return{width:d,height:e,top:c,left:b,right:b+d,bottom:c+e,x:b,y:c}}function B(a,b,c){let d,{reference:e,floating:f}=a,g=s(b),h=p(s(b)),i=q(h),j=n(b),k="y"===g,l=e.x+e.width/2-f.width/2,m=e.y+e.height/2-f.height/2,r=e[i]/2-f[i]/2;switch(j){case"top":d={x:l,y:e.y-f.height};break;case"bottom":d={x:l,y:e.y+e.height};break;case"right":d={x:e.x+e.width,y:m};break;case"left":d={x:e.x-f.width,y:m};break;default:d={x:e.x,y:e.y}}switch(o(b)){case"start":d[h]-=r*(c&&k?-1:1);break;case"end":d[h]+=r*(c&&k?-1:1)}return d}async function C(a,b){var c;void 0===b&&(b={});let{x:d,y:e,platform:f,rects:g,elements:h,strategy:i}=a,{boundary:j="clippingAncestors",rootBoundary:k="viewport",elementContext:l="floating",altBoundary:n=!1,padding:o=0}=m(b,a),p=z(o),q=h[n?"floating"===l?"reference":"floating":l],r=A(await f.getClippingRect({element:null==(c=await (null==f.isElement?void 0:f.isElement(q)))||c?q:q.contextElement||await (null==f.getDocumentElement?void 0:f.getDocumentElement(h.floating)),boundary:j,rootBoundary:k,strategy:i})),s="floating"===l?{x:d,y:e,width:g.floating.width,height:g.floating.height}:g.reference,t=await (null==f.getOffsetParent?void 0:f.getOffsetParent(h.floating)),u=await (null==f.isElement?void 0:f.isElement(t))&&await (null==f.getScale?void 0:f.getScale(t))||{x:1,y:1},v=A(f.convertOffsetParentRelativeRectToViewportRelativeRect?await f.convertOffsetParentRelativeRectToViewportRelativeRect({elements:h,rect:s,offsetParent:t,strategy:i}):s);return{top:(r.top-v.top+p.top)/u.y,bottom:(v.bottom-r.bottom+p.bottom)/u.y,left:(r.left-v.left+p.left)/u.x,right:(v.right-r.right+p.right)/u.x}}let D=async(a,b,c)=>{let{placement:d="bottom",strategy:e="absolute",middleware:f=[],platform:g}=c,h=f.filter(Boolean),i=await (null==g.isRTL?void 0:g.isRTL(b)),j=await g.getElementRects({reference:a,floating:b,strategy:e}),{x:k,y:l}=B(j,d,i),m=d,n={},o=0;for(let c=0;c<h.length;c++){var p;let{name:f,fn:q}=h[c],{x:r,y:s,data:t,reset:u}=await q({x:k,y:l,initialPlacement:d,placement:m,strategy:e,middlewareData:n,rects:j,platform:{...g,detectOverflow:null!=(p=g.detectOverflow)?p:C},elements:{reference:a,floating:b}});k=null!=r?r:k,l=null!=s?s:l,n={...n,[f]:{...n[f],...t}},u&&o<=50&&(o++,"object"==typeof u&&(u.placement&&(m=u.placement),u.rects&&(j=!0===u.rects?await g.getElementRects({reference:a,floating:b,strategy:e}):u.rects),{x:k,y:l}=B(j,m,i)),c=-1)}return{x:k,y:l,placement:m,strategy:e,middlewareData:n}};function E(a,b){return{top:a.top-b.height,right:a.right-b.width,bottom:a.bottom-b.height,left:a.left-b.width}}function F(a){return e.some(b=>a[b]>=0)}let G=new Set(["left","top"]);async function H(a,b){let{placement:c,platform:d,elements:e}=a,f=await (null==d.isRTL?void 0:d.isRTL(e.floating)),g=n(c),h=o(c),i="y"===s(c),j=G.has(g)?-1:1,k=f&&i?-1:1,l=m(b,a),{mainAxis:p,crossAxis:q,alignmentAxis:r}="number"==typeof l?{mainAxis:l,crossAxis:0,alignmentAxis:null}:{mainAxis:l.mainAxis||0,crossAxis:l.crossAxis||0,alignmentAxis:l.alignmentAxis};return h&&"number"==typeof r&&(q="end"===h?-1*r:r),i?{x:q*k,y:p*j}:{x:p*j,y:q*k}}function I(){return"undefined"!=typeof window}function J(a){return M(a)?(a.nodeName||"").toLowerCase():"#document"}function K(a){var b;return(null==a||null==(b=a.ownerDocument)?void 0:b.defaultView)||window}function L(a){var b;return null==(b=(M(a)?a.ownerDocument:a.document)||window.document)?void 0:b.documentElement}function M(a){return!!I()&&(a instanceof Node||a instanceof K(a).Node)}function N(a){return!!I()&&(a instanceof Element||a instanceof K(a).Element)}function O(a){return!!I()&&(a instanceof HTMLElement||a instanceof K(a).HTMLElement)}function P(a){return!!I()&&"undefined"!=typeof ShadowRoot&&(a instanceof ShadowRoot||a instanceof K(a).ShadowRoot)}let Q=new Set(["inline","contents"]);function R(a){let{overflow:b,overflowX:c,overflowY:d,display:e}=aa(a);return/auto|scroll|overlay|hidden|clip/.test(b+d+c)&&!Q.has(e)}let S=new Set(["table","td","th"]),T=[":popover-open",":modal"];function U(a){return T.some(b=>{try{return a.matches(b)}catch(a){return!1}})}let V=["transform","translate","scale","rotate","perspective"],W=["transform","translate","scale","rotate","perspective","filter"],X=["paint","layout","strict","content"];function Y(a){let b=Z(),c=N(a)?aa(a):a;return V.some(a=>!!c[a]&&"none"!==c[a])||!!c.containerType&&"normal"!==c.containerType||!b&&!!c.backdropFilter&&"none"!==c.backdropFilter||!b&&!!c.filter&&"none"!==c.filter||W.some(a=>(c.willChange||"").includes(a))||X.some(a=>(c.contain||"").includes(a))}function Z(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}let $=new Set(["html","body","#document"]);function _(a){return $.has(J(a))}function aa(a){return K(a).getComputedStyle(a)}function ab(a){return N(a)?{scrollLeft:a.scrollLeft,scrollTop:a.scrollTop}:{scrollLeft:a.scrollX,scrollTop:a.scrollY}}function ac(a){if("html"===J(a))return a;let b=a.assignedSlot||a.parentNode||P(a)&&a.host||L(a);return P(b)?b.host:b}function ad(a,b,c){var d;void 0===b&&(b=[]),void 0===c&&(c=!0);let e=function a(b){let c=ac(b);return _(c)?b.ownerDocument?b.ownerDocument.body:b.body:O(c)&&R(c)?c:a(c)}(a),f=e===(null==(d=a.ownerDocument)?void 0:d.body),g=K(e);if(f){let a=ae(g);return b.concat(g,g.visualViewport||[],R(e)?e:[],a&&c?ad(a):[])}return b.concat(e,ad(e,[],c))}function ae(a){return a.parent&&Object.getPrototypeOf(a.parent)?a.frameElement:null}function af(a){let b=aa(a),c=parseFloat(b.width)||0,d=parseFloat(b.height)||0,e=O(a),f=e?a.offsetWidth:c,g=e?a.offsetHeight:d,i=h(c)!==f||h(d)!==g;return i&&(c=f,d=g),{width:c,height:d,$:i}}function ag(a){return N(a)?a:a.contextElement}function ah(a){let b=ag(a);if(!O(b))return j(1);let c=b.getBoundingClientRect(),{width:d,height:e,$:f}=af(b),g=(f?h(c.width):c.width)/d,i=(f?h(c.height):c.height)/e;return g&&Number.isFinite(g)||(g=1),i&&Number.isFinite(i)||(i=1),{x:g,y:i}}let ai=j(0);function aj(a){let b=K(a);return Z()&&b.visualViewport?{x:b.visualViewport.offsetLeft,y:b.visualViewport.offsetTop}:ai}function ak(a,b,c,d){var e;void 0===b&&(b=!1),void 0===c&&(c=!1);let f=a.getBoundingClientRect(),g=ag(a),h=j(1);b&&(d?N(d)&&(h=ah(d)):h=ah(a));let i=(void 0===(e=c)&&(e=!1),d&&(!e||d===K(g))&&e)?aj(g):j(0),k=(f.left+i.x)/h.x,l=(f.top+i.y)/h.y,m=f.width/h.x,n=f.height/h.y;if(g){let a=K(g),b=d&&N(d)?K(d):d,c=a,e=ae(c);for(;e&&d&&b!==c;){let a=ah(e),b=e.getBoundingClientRect(),d=aa(e),f=b.left+(e.clientLeft+parseFloat(d.paddingLeft))*a.x,g=b.top+(e.clientTop+parseFloat(d.paddingTop))*a.y;k*=a.x,l*=a.y,m*=a.x,n*=a.y,k+=f,l+=g,e=ae(c=K(e))}}return A({width:m,height:n,x:k,y:l})}function al(a,b){let c=ab(a).scrollLeft;return b?b.left+c:ak(L(a)).left+c}function am(a,b){let c=a.getBoundingClientRect();return{x:c.left+b.scrollLeft-al(a,c),y:c.top+b.scrollTop}}let an=new Set(["absolute","fixed"]);function ao(a,b,c){let d;if("viewport"===b)d=function(a,b){let c=K(a),d=L(a),e=c.visualViewport,f=d.clientWidth,g=d.clientHeight,h=0,i=0;if(e){f=e.width,g=e.height;let a=Z();(!a||a&&"fixed"===b)&&(h=e.offsetLeft,i=e.offsetTop)}let j=al(d);if(j<=0){let a=d.ownerDocument,b=a.body,c=getComputedStyle(b),e="CSS1Compat"===a.compatMode&&parseFloat(c.marginLeft)+parseFloat(c.marginRight)||0,g=Math.abs(d.clientWidth-b.clientWidth-e);g<=25&&(f-=g)}else j<=25&&(f+=j);return{width:f,height:g,x:h,y:i}}(a,c);else if("document"===b)d=function(a){let b=L(a),c=ab(a),d=a.ownerDocument.body,e=g(b.scrollWidth,b.clientWidth,d.scrollWidth,d.clientWidth),f=g(b.scrollHeight,b.clientHeight,d.scrollHeight,d.clientHeight),h=-c.scrollLeft+al(a),i=-c.scrollTop;return"rtl"===aa(d).direction&&(h+=g(b.clientWidth,d.clientWidth)-e),{width:e,height:f,x:h,y:i}}(L(a));else if(N(b))d=function(a,b){let c=ak(a,!0,"fixed"===b),d=c.top+a.clientTop,e=c.left+a.clientLeft,f=O(a)?ah(a):j(1),g=a.clientWidth*f.x,h=a.clientHeight*f.y;return{width:g,height:h,x:e*f.x,y:d*f.y}}(b,c);else{let c=aj(a);d={x:b.x-c.x,y:b.y-c.y,width:b.width,height:b.height}}return A(d)}function ap(a){return"static"===aa(a).position}function aq(a,b){if(!O(a)||"fixed"===aa(a).position)return null;if(b)return b(a);let c=a.offsetParent;return L(a)===c&&(c=c.ownerDocument.body),c}function ar(a,b){var c;let d=K(a);if(U(a))return d;if(!O(a)){let b=ac(a);for(;b&&!_(b);){if(N(b)&&!ap(b))return b;b=ac(b)}return d}let e=aq(a,b);for(;e&&(c=e,S.has(J(c)))&&ap(e);)e=aq(e,b);return e&&_(e)&&ap(e)&&!Y(e)?d:e||function(a){let b=ac(a);for(;O(b)&&!_(b);){if(Y(b))return b;if(U(b))break;b=ac(b)}return null}(a)||d}let as=async function(a){let b=this.getOffsetParent||ar,c=this.getDimensions,d=await c(a.floating);return{reference:function(a,b,c){let d=O(b),e=L(b),f="fixed"===c,g=ak(a,!0,f,b),h={scrollLeft:0,scrollTop:0},i=j(0);if(d||!d&&!f)if(("body"!==J(b)||R(e))&&(h=ab(b)),d){let a=ak(b,!0,f,b);i.x=a.x+b.clientLeft,i.y=a.y+b.clientTop}else e&&(i.x=al(e));f&&!d&&e&&(i.x=al(e));let k=!e||d||f?j(0):am(e,h);return{x:g.left+h.scrollLeft-i.x-k.x,y:g.top+h.scrollTop-i.y-k.y,width:g.width,height:g.height}}(a.reference,await b(a.floating),a.strategy),floating:{x:0,y:0,width:d.width,height:d.height}}},at={convertOffsetParentRelativeRectToViewportRelativeRect:function(a){let{elements:b,rect:c,offsetParent:d,strategy:e}=a,f="fixed"===e,g=L(d),h=!!b&&U(b.floating);if(d===g||h&&f)return c;let i={scrollLeft:0,scrollTop:0},k=j(1),l=j(0),m=O(d);if((m||!m&&!f)&&(("body"!==J(d)||R(g))&&(i=ab(d)),O(d))){let a=ak(d);k=ah(d),l.x=a.x+d.clientLeft,l.y=a.y+d.clientTop}let n=!g||m||f?j(0):am(g,i);return{width:c.width*k.x,height:c.height*k.y,x:c.x*k.x-i.scrollLeft*k.x+l.x+n.x,y:c.y*k.y-i.scrollTop*k.y+l.y+n.y}},getDocumentElement:L,getClippingRect:function(a){let{element:b,boundary:c,rootBoundary:d,strategy:e}=a,h=[..."clippingAncestors"===c?U(b)?[]:function(a,b){let c=b.get(a);if(c)return c;let d=ad(a,[],!1).filter(a=>N(a)&&"body"!==J(a)),e=null,f="fixed"===aa(a).position,g=f?ac(a):a;for(;N(g)&&!_(g);){let b=aa(g),c=Y(g);c||"fixed"!==b.position||(e=null),(f?!c&&!e:!c&&"static"===b.position&&!!e&&an.has(e.position)||R(g)&&!c&&function a(b,c){let d=ac(b);return!(d===c||!N(d)||_(d))&&("fixed"===aa(d).position||a(d,c))}(a,g))?d=d.filter(a=>a!==g):e=b,g=ac(g)}return b.set(a,d),d}(b,this._c):[].concat(c),d],i=h[0],j=h.reduce((a,c)=>{let d=ao(b,c,e);return a.top=g(d.top,a.top),a.right=f(d.right,a.right),a.bottom=f(d.bottom,a.bottom),a.left=g(d.left,a.left),a},ao(b,i,e));return{width:j.right-j.left,height:j.bottom-j.top,x:j.left,y:j.top}},getOffsetParent:ar,getElementRects:as,getClientRects:function(a){return Array.from(a.getClientRects())},getDimensions:function(a){let{width:b,height:c}=af(a);return{width:b,height:c}},getScale:ah,isElement:N,isRTL:function(a){return"rtl"===aa(a).direction}};function au(a,b){return a.x===b.x&&a.y===b.y&&a.width===b.width&&a.height===b.height}let av=a=>({name:"arrow",options:a,async fn(b){let{x:c,y:d,placement:e,rects:h,platform:i,elements:j,middlewareData:k}=b,{element:l,padding:n=0}=m(a,b)||{};if(null==l)return{};let r=z(n),t={x:c,y:d},u=p(s(e)),v=q(u),w=await i.getDimensions(l),x="y"===u,y=x?"clientHeight":"clientWidth",A=h.reference[v]+h.reference[u]-t[u]-h.floating[v],B=t[u]-h.reference[u],C=await (null==i.getOffsetParent?void 0:i.getOffsetParent(l)),D=C?C[y]:0;D&&await (null==i.isElement?void 0:i.isElement(C))||(D=j.floating[y]||h.floating[v]);let E=D/2-w[v]/2-1,F=f(r[x?"top":"left"],E),G=f(r[x?"bottom":"right"],E),H=D-w[v]-G,I=D/2-w[v]/2+(A/2-B/2),J=g(F,f(I,H)),K=!k.arrow&&null!=o(e)&&I!==J&&h.reference[v]/2-(I<F?F:G)-w[v]/2<0,L=K?I<F?I-F:I-H:0;return{[u]:t[u]+L,data:{[u]:J,centerOffset:I-J-L,...K&&{alignmentOffset:L}},reset:K}}});var aw=c(23312),ax="undefined"!=typeof document?d.useLayoutEffect:function(){};function ay(a,b){let c,d,e;if(a===b)return!0;if(typeof a!=typeof b)return!1;if("function"==typeof a&&a.toString()===b.toString())return!0;if(a&&b&&"object"==typeof a){if(Array.isArray(a)){if((c=a.length)!==b.length)return!1;for(d=c;0!=d--;)if(!ay(a[d],b[d]))return!1;return!0}if((c=(e=Object.keys(a)).length)!==Object.keys(b).length)return!1;for(d=c;0!=d--;)if(!({}).hasOwnProperty.call(b,e[d]))return!1;for(d=c;0!=d--;){let c=e[d];if(("_owner"!==c||!a.$$typeof)&&!ay(a[c],b[c]))return!1}return!0}return a!=a&&b!=b}function az(a){return"undefined"==typeof window?1:(a.ownerDocument.defaultView||window).devicePixelRatio||1}function aA(a,b){let c=az(a);return Math.round(b*c)/c}function aB(a){let b=d.useRef(a);return ax(()=>{b.current=a}),b}var aC=c(99978),aD=c(21124),aE=d.forwardRef((a,b)=>{let{children:c,width:d=10,height:e=5,...f}=a;return(0,aD.jsx)(aC.sG.svg,{...f,ref:b,width:d,height:e,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:a.asChild?c:(0,aD.jsx)("polygon",{points:"0,0 30,0 15,10"})})});aE.displayName="Arrow";var aF=c(92808),aG=c(2332),aH=c(71700),aI=c(68829),aJ=c(96386),aK="Popper",[aL,aM]=(0,aG.A)(aK),[aN,aO]=aL(aK),aP=a=>{let{__scopePopper:b,children:c}=a,[e,f]=d.useState(null);return(0,aD.jsx)(aN,{scope:b,anchor:e,onAnchorChange:f,children:c})};aP.displayName=aK;var aQ="PopperAnchor",aR=d.forwardRef((a,b)=>{let{__scopePopper:c,virtualRef:e,...f}=a,g=aO(aQ,c),h=d.useRef(null),i=(0,aF.s)(b,h),j=d.useRef(null);return d.useEffect(()=>{let a=j.current;j.current=e?.current||h.current,a!==j.current&&g.onAnchorChange(j.current)}),e?null:(0,aD.jsx)(aC.sG.div,{...f,ref:i})});aR.displayName=aQ;var aS="PopperContent",[aT,aU]=aL(aS),aV=d.forwardRef((a,b)=>{let{__scopePopper:c,side:e="bottom",sideOffset:h=0,align:j="center",alignOffset:k=0,arrowPadding:l=0,avoidCollisions:r=!0,collisionBoundary:z=[],collisionPadding:A=0,sticky:B="partial",hideWhenDetached:C=!1,updatePositionStrategy:I="optimized",onPlaced:J,...K}=a,M=aO(aS,c),[N,O]=d.useState(null),P=(0,aF.s)(b,a=>O(a)),[Q,R]=d.useState(null),S=(0,aJ.X)(Q),T=S?.width??0,U=S?.height??0,V="number"==typeof A?A:{top:0,right:0,bottom:0,left:0,...A},W=Array.isArray(z)?z:[z],X=W.length>0,Y={padding:V,boundary:W.filter(aZ),altBoundary:X},{refs:Z,floatingStyles:$,placement:_,isPositioned:aa,middlewareData:ab}=function(a){void 0===a&&(a={});let{placement:b="bottom",strategy:c="absolute",middleware:e=[],platform:f,elements:{reference:g,floating:h}={},transform:i=!0,whileElementsMounted:j,open:k}=a,[l,m]=d.useState({x:0,y:0,strategy:c,placement:b,middlewareData:{},isPositioned:!1}),[n,o]=d.useState(e);ay(n,e)||o(e);let[p,q]=d.useState(null),[r,s]=d.useState(null),t=d.useCallback(a=>{a!==x.current&&(x.current=a,q(a))},[]),u=d.useCallback(a=>{a!==y.current&&(y.current=a,s(a))},[]),v=g||p,w=h||r,x=d.useRef(null),y=d.useRef(null),z=d.useRef(l),A=null!=j,B=aB(j),C=aB(f),E=aB(k),F=d.useCallback(()=>{if(!x.current||!y.current)return;let a={placement:b,strategy:c,middleware:n};C.current&&(a.platform=C.current),((a,b,c)=>{let d=new Map,e={platform:at,...c},f={...e.platform,_c:d};return D(a,b,{...e,platform:f})})(x.current,y.current,a).then(a=>{let b={...a,isPositioned:!1!==E.current};G.current&&!ay(z.current,b)&&(z.current=b,aw.flushSync(()=>{m(b)}))})},[n,b,c,C,E]);ax(()=>{!1===k&&z.current.isPositioned&&(z.current.isPositioned=!1,m(a=>({...a,isPositioned:!1})))},[k]);let G=d.useRef(!1);ax(()=>(G.current=!0,()=>{G.current=!1}),[]),ax(()=>{if(v&&(x.current=v),w&&(y.current=w),v&&w){if(B.current)return B.current(v,w,F);F()}},[v,w,F,B,A]);let H=d.useMemo(()=>({reference:x,floating:y,setReference:t,setFloating:u}),[t,u]),I=d.useMemo(()=>({reference:v,floating:w}),[v,w]),J=d.useMemo(()=>{let a={position:c,left:0,top:0};if(!I.floating)return a;let b=aA(I.floating,l.x),d=aA(I.floating,l.y);return i?{...a,transform:"translate("+b+"px, "+d+"px)",...az(I.floating)>=1.5&&{willChange:"transform"}}:{position:c,left:b,top:d}},[c,i,I.floating,l.x,l.y]);return d.useMemo(()=>({...l,update:F,refs:H,elements:I,floatingStyles:J}),[l,F,H,I,J])}({strategy:"fixed",placement:e+("center"!==j?"-"+j:""),whileElementsMounted:(...a)=>(function(a,b,c,d){let e;void 0===d&&(d={});let{ancestorScroll:h=!0,ancestorResize:j=!0,elementResize:k="function"==typeof ResizeObserver,layoutShift:l="function"==typeof IntersectionObserver,animationFrame:m=!1}=d,n=ag(a),o=h||j?[...n?ad(n):[],...ad(b)]:[];o.forEach(a=>{h&&a.addEventListener("scroll",c,{passive:!0}),j&&a.addEventListener("resize",c)});let p=n&&l?function(a,b){let c,d=null,e=L(a);function h(){var a;clearTimeout(c),null==(a=d)||a.disconnect(),d=null}return!function j(k,l){void 0===k&&(k=!1),void 0===l&&(l=1),h();let m=a.getBoundingClientRect(),{left:n,top:o,width:p,height:q}=m;if(k||b(),!p||!q)return;let r=i(o),s=i(e.clientWidth-(n+p)),t={rootMargin:-r+"px "+-s+"px "+-i(e.clientHeight-(o+q))+"px "+-i(n)+"px",threshold:g(0,f(1,l))||1},u=!0;function v(b){let d=b[0].intersectionRatio;if(d!==l){if(!u)return j();d?j(!1,d):c=setTimeout(()=>{j(!1,1e-7)},1e3)}1!==d||au(m,a.getBoundingClientRect())||j(),u=!1}try{d=new IntersectionObserver(v,{...t,root:e.ownerDocument})}catch(a){d=new IntersectionObserver(v,t)}d.observe(a)}(!0),h}(n,c):null,q=-1,r=null;k&&(r=new ResizeObserver(a=>{let[d]=a;d&&d.target===n&&r&&(r.unobserve(b),cancelAnimationFrame(q),q=requestAnimationFrame(()=>{var a;null==(a=r)||a.observe(b)})),c()}),n&&!m&&r.observe(n),r.observe(b));let s=m?ak(a):null;return m&&function b(){let d=ak(a);s&&!au(s,d)&&c(),s=d,e=requestAnimationFrame(b)}(),c(),()=>{var a;o.forEach(a=>{h&&a.removeEventListener("scroll",c),j&&a.removeEventListener("resize",c)}),null==p||p(),null==(a=r)||a.disconnect(),r=null,m&&cancelAnimationFrame(e)}})(...a,{animationFrame:"always"===I}),elements:{reference:M.anchor},middleware:[((a,b)=>({...function(a){return void 0===a&&(a=0),{name:"offset",options:a,async fn(b){var c,d;let{x:e,y:f,placement:g,middlewareData:h}=b,i=await H(b,a);return g===(null==(c=h.offset)?void 0:c.placement)&&null!=(d=h.arrow)&&d.alignmentOffset?{}:{x:e+i.x,y:f+i.y,data:{...i,placement:g}}}}}(a),options:[a,void 0]}))({mainAxis:h+U,alignmentAxis:k}),r&&((a,b)=>({...function(a){return void 0===a&&(a={}),{name:"shift",options:a,async fn(b){let{x:c,y:d,placement:e,platform:h}=b,{mainAxis:i=!0,crossAxis:j=!1,limiter:k={fn:a=>{let{x:b,y:c}=a;return{x:b,y:c}}},...l}=m(a,b),o={x:c,y:d},q=await h.detectOverflow(b,l),r=s(n(e)),t=p(r),u=o[t],v=o[r];if(i){let a="y"===t?"top":"left",b="y"===t?"bottom":"right",c=u+q[a],d=u-q[b];u=g(c,f(u,d))}if(j){let a="y"===r?"top":"left",b="y"===r?"bottom":"right",c=v+q[a],d=v-q[b];v=g(c,f(v,d))}let w=k.fn({...b,[t]:u,[r]:v});return{...w,data:{x:w.x-c,y:w.y-d,enabled:{[t]:i,[r]:j}}}}}}(a),options:[a,void 0]}))({mainAxis:!0,crossAxis:!1,limiter:"partial"===B?{...function(a){return void 0===a&&(a={}),{options:a,fn(b){let{x:c,y:d,placement:e,rects:f,middlewareData:g}=b,{offset:h=0,mainAxis:i=!0,crossAxis:j=!0}=m(a,b),k={x:c,y:d},l=s(e),o=p(l),q=k[o],r=k[l],t=m(h,b),u="number"==typeof t?{mainAxis:t,crossAxis:0}:{mainAxis:0,crossAxis:0,...t};if(i){let a="y"===o?"height":"width",b=f.reference[o]-f.floating[a]+u.mainAxis,c=f.reference[o]+f.reference[a]-u.mainAxis;q<b?q=b:q>c&&(q=c)}if(j){var v,w;let a="y"===o?"width":"height",b=G.has(n(e)),c=f.reference[l]-f.floating[a]+(b&&(null==(v=g.offset)?void 0:v[l])||0)+(b?0:u.crossAxis),d=f.reference[l]+f.reference[a]+(b?0:(null==(w=g.offset)?void 0:w[l])||0)-(b?u.crossAxis:0);r<c?r=c:r>d&&(r=d)}return{[o]:q,[l]:r}}}}(void 0),options:[void 0,void 0]}:void 0,...Y}),r&&((a,b)=>({...function(a){return void 0===a&&(a={}),{name:"flip",options:a,async fn(b){var c,d,e,f,g;let{placement:h,middlewareData:i,rects:j,initialPlacement:k,platform:l,elements:r}=b,{mainAxis:z=!0,crossAxis:A=!0,fallbackPlacements:B,fallbackStrategy:C="bestFit",fallbackAxisSideDirection:D="none",flipAlignment:E=!0,...F}=m(a,b);if(null!=(c=i.arrow)&&c.alignmentOffset)return{};let G=n(h),H=s(k),I=n(k)===k,J=await (null==l.isRTL?void 0:l.isRTL(r.floating)),K=B||(I||!E?[y(k)]:function(a){let b=y(a);return[t(a),b,t(b)]}(k)),L="none"!==D;!B&&L&&K.push(...function(a,b,c,d){let e=o(a),f=function(a,b,c){switch(a){case"top":case"bottom":if(c)return b?v:u;return b?u:v;case"left":case"right":return b?w:x;default:return[]}}(n(a),"start"===c,d);return e&&(f=f.map(a=>a+"-"+e),b&&(f=f.concat(f.map(t)))),f}(k,E,D,J));let M=[k,...K],N=await l.detectOverflow(b,F),O=[],P=(null==(d=i.flip)?void 0:d.overflows)||[];if(z&&O.push(N[G]),A){let a=function(a,b,c){void 0===c&&(c=!1);let d=o(a),e=p(s(a)),f=q(e),g="x"===e?d===(c?"end":"start")?"right":"left":"start"===d?"bottom":"top";return b.reference[f]>b.floating[f]&&(g=y(g)),[g,y(g)]}(h,j,J);O.push(N[a[0]],N[a[1]])}if(P=[...P,{placement:h,overflows:O}],!O.every(a=>a<=0)){let a=((null==(e=i.flip)?void 0:e.index)||0)+1,b=M[a];if(b&&("alignment"!==A||H===s(b)||P.every(a=>s(a.placement)!==H||a.overflows[0]>0)))return{data:{index:a,overflows:P},reset:{placement:b}};let c=null==(f=P.filter(a=>a.overflows[0]<=0).sort((a,b)=>a.overflows[1]-b.overflows[1])[0])?void 0:f.placement;if(!c)switch(C){case"bestFit":{let a=null==(g=P.filter(a=>{if(L){let b=s(a.placement);return b===H||"y"===b}return!0}).map(a=>[a.placement,a.overflows.filter(a=>a>0).reduce((a,b)=>a+b,0)]).sort((a,b)=>a[1]-b[1])[0])?void 0:g[0];a&&(c=a);break}case"initialPlacement":c=k}if(h!==c)return{reset:{placement:c}}}return{}}}}(a),options:[a,void 0]}))({...Y}),((a,b)=>({...function(a){return void 0===a&&(a={}),{name:"size",options:a,async fn(b){var c,d;let e,h,{placement:i,rects:j,platform:k,elements:l}=b,{apply:p=()=>{},...q}=m(a,b),r=await k.detectOverflow(b,q),t=n(i),u=o(i),v="y"===s(i),{width:w,height:x}=j.floating;"top"===t||"bottom"===t?(e=t,h=u===(await (null==k.isRTL?void 0:k.isRTL(l.floating))?"start":"end")?"left":"right"):(h=t,e="end"===u?"top":"bottom");let y=x-r.top-r.bottom,z=w-r.left-r.right,A=f(x-r[e],y),B=f(w-r[h],z),C=!b.middlewareData.shift,D=A,E=B;if(null!=(c=b.middlewareData.shift)&&c.enabled.x&&(E=z),null!=(d=b.middlewareData.shift)&&d.enabled.y&&(D=y),C&&!u){let a=g(r.left,0),b=g(r.right,0),c=g(r.top,0),d=g(r.bottom,0);v?E=w-2*(0!==a||0!==b?a+b:g(r.left,r.right)):D=x-2*(0!==c||0!==d?c+d:g(r.top,r.bottom))}await p({...b,availableWidth:E,availableHeight:D});let F=await k.getDimensions(l.floating);return w!==F.width||x!==F.height?{reset:{rects:!0}}:{}}}}(a),options:[a,void 0]}))({...Y,apply:({elements:a,rects:b,availableWidth:c,availableHeight:d})=>{let{width:e,height:f}=b.reference,g=a.floating.style;g.setProperty("--radix-popper-available-width",`${c}px`),g.setProperty("--radix-popper-available-height",`${d}px`),g.setProperty("--radix-popper-anchor-width",`${e}px`),g.setProperty("--radix-popper-anchor-height",`${f}px`)}}),Q&&((a,b)=>({...(a=>({name:"arrow",options:a,fn(b){let{element:c,padding:d}="function"==typeof a?a(b):a;return c&&({}).hasOwnProperty.call(c,"current")?null!=c.current?av({element:c.current,padding:d}).fn(b):{}:c?av({element:c,padding:d}).fn(b):{}}}))(a),options:[a,void 0]}))({element:Q,padding:l}),a$({arrowWidth:T,arrowHeight:U}),C&&((a,b)=>({...function(a){return void 0===a&&(a={}),{name:"hide",options:a,async fn(b){let{rects:c,platform:d}=b,{strategy:e="referenceHidden",...f}=m(a,b);switch(e){case"referenceHidden":{let a=E(await d.detectOverflow(b,{...f,elementContext:"reference"}),c.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:F(a)}}}case"escaped":{let a=E(await d.detectOverflow(b,{...f,altBoundary:!0}),c.floating);return{data:{escapedOffsets:a,escaped:F(a)}}}default:return{}}}}}(a),options:[a,void 0]}))({strategy:"referenceHidden",...Y})]}),[ac,ae]=a_(_),af=(0,aH.c)(J);(0,aI.N)(()=>{aa&&af?.()},[aa,af]);let ah=ab.arrow?.x,ai=ab.arrow?.y,aj=ab.arrow?.centerOffset!==0,[al,am]=d.useState();return(0,aI.N)(()=>{N&&am(window.getComputedStyle(N).zIndex)},[N]),(0,aD.jsx)("div",{ref:Z.setFloating,"data-radix-popper-content-wrapper":"",style:{...$,transform:aa?$.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:al,"--radix-popper-transform-origin":[ab.transformOrigin?.x,ab.transformOrigin?.y].join(" "),...ab.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:a.dir,children:(0,aD.jsx)(aT,{scope:c,placedSide:ac,onArrowChange:R,arrowX:ah,arrowY:ai,shouldHideArrow:aj,children:(0,aD.jsx)(aC.sG.div,{"data-side":ac,"data-align":ae,...K,ref:P,style:{...K.style,animation:aa?void 0:"none"}})})})});aV.displayName=aS;var aW="PopperArrow",aX={top:"bottom",right:"left",bottom:"top",left:"right"},aY=d.forwardRef(function(a,b){let{__scopePopper:c,...d}=a,e=aU(aW,c),f=aX[e.placedSide];return(0,aD.jsx)("span",{ref:e.onArrowChange,style:{position:"absolute",left:e.arrowX,top:e.arrowY,[f]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[e.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[e.placedSide],visibility:e.shouldHideArrow?"hidden":void 0},children:(0,aD.jsx)(aE,{...d,ref:b,style:{...d.style,display:"block"}})})});function aZ(a){return null!==a}aY.displayName=aW;var a$=a=>({name:"transformOrigin",options:a,fn(b){let{placement:c,rects:d,middlewareData:e}=b,f=e.arrow?.centerOffset!==0,g=f?0:a.arrowWidth,h=f?0:a.arrowHeight,[i,j]=a_(c),k={start:"0%",center:"50%",end:"100%"}[j],l=(e.arrow?.x??0)+g/2,m=(e.arrow?.y??0)+h/2,n="",o="";return"bottom"===i?(n=f?k:`${l}px`,o=`${-h}px`):"top"===i?(n=f?k:`${l}px`,o=`${d.floating.height+h}px`):"right"===i?(n=`${-h}px`,o=f?k:`${m}px`):"left"===i&&(n=`${d.floating.width+h}px`,o=f?k:`${m}px`),{data:{x:n,y:o}}}});function a_(a){let[b,c="center"]=a.split("-");return[b,c]}var a0=aP,a1=aR,a2=aV,a3=aY},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},28354:a=>{"use strict";a.exports=require("util")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33305:(a,b,c)=>{"use strict";c.d(b,{Cf:()=>m,Es:()=>q,L3:()=>o,c7:()=>n,lG:()=>i,rr:()=>p,zM:()=>j});var d=c(21124),e=c(38301),f=c(6843),g=c(47089),h=c(15514);let i=f.bL,j=f.l9,k=f.ZL;f.bm;let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hJ,{ref:c,className:(0,h.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b}));l.displayName=f.hJ.displayName;let m=e.forwardRef(({className:a,children:b,showClose:c=!0,...e},i)=>(0,d.jsxs)(k,{children:[(0,d.jsx)(l,{}),(0,d.jsxs)(f.UC,{ref:i,className:(0,h.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg",a),...e,children:[b,c&&(0,d.jsxs)(f.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,d.jsx)(g.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"閉じる"})]})]})]}));m.displayName=f.UC.displayName;let n=({className:a,...b})=>(0,d.jsx)("div",{className:(0,h.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...b});n.displayName="DialogHeader";let o=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hE,{ref:c,className:(0,h.cn)("text-lg font-semibold leading-none tracking-tight",a),...b}));o.displayName=f.hE.displayName;let p=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.VY,{ref:c,className:(0,h.cn)("text-sm text-muted-foreground",a),...b}));p.displayName=f.VY.displayName;let q=({className:a,...b})=>(0,d.jsx)("div",{className:(0,h.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...b});q.displayName="DialogFooter"},33508:(a,b,c)=>{"use strict";c.d(b,{FamiliesTable:()=>E});var d=c(21124),e=c(38301),f=c(52300),g=c(7240),h=c(22544),i=c(19217),j=c(17677),k=c(14263),l=c(65893),m=c(85351),n=c(59405),o=c(7629),p=c(53199),q=c(33305),r=c(83047),s=c(23339);let t=(0,s.A)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var u=c(88285),v=c(92500);let w=a=>fetch(a).then(a=>a.json());function x({family:a,open:b,onOpenChange:c,onSuccess:g}){let[h,j]=(0,e.useState)(""),[l,m]=(0,e.useState)([]),[n,s]=(0,e.useState)(!1),{data:x=[]}=(0,f.Ay)("/api/profiles",w),y=a.members.map(a=>a.id),z=x.filter(a=>{if(y.includes(a.id)||l.some(b=>b.profile.id===a.id)||!h.trim())return!1;let b=h.toLowerCase();return a.display_name?.toLowerCase().includes(b)||a.ticket_number?.toLowerCase().includes(b)});async function A(){if(0===l.length)return void alert("追加するメンバーを選択してください");s(!0);try{for(let b of l){let c=await fetch(`/api/families/${a.id}/members`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:b.profile.id,family_role:b.role})});if(!c.ok){let a=await c.json();throw Error(a.error||`${b.profile.display_name} の追加に失敗しました`)}}g(),c(!1),j(""),m([])}catch(a){console.error("メンバー追加エラー:",a),alert(a instanceof Error?a.message:"メンバーの追加に失敗しました。もう一度お試しください。")}finally{s(!1)}}return(0,d.jsx)(q.lG,{open:b,onOpenChange:c,children:(0,d.jsxs)(q.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,d.jsx)(q.c7,{children:(0,d.jsxs)(q.L3,{className:"flex items-center gap-2",children:[(0,d.jsx)(t,{className:"h-5 w-5"}),"メンバーを追加 - ",a.family_name]})}),(0,d.jsxs)("div",{className:"space-y-6 py-4",children:[(0,d.jsxs)("div",{className:"text-sm text-muted-foreground",children:["現在のメンバー数: ",a.member_count,"人"]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(p.J,{children:"追加するメンバーを検索"}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(u.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,d.jsx)(o.p,{value:h,onChange:a=>j(a.target.value),placeholder:"名前または診察券番号で検索...",className:"pl-10"})]})]}),h.trim()&&(0,d.jsx)("div",{className:"space-y-2 max-h-[200px] overflow-y-auto border rounded-lg p-2",children:0===z.length?(0,d.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"該当する患者がいません"}):z.map(a=>{let b=l.some(b=>b.profile.id===a.id);return(0,d.jsxs)("div",{className:"flex items-center gap-3 p-2 hover:bg-slate-50 rounded cursor-pointer",onClick:()=>{l.find(b=>b.profile.id===a.id)?m(l.filter(b=>b.profile.id!==a.id)):m([...l,{profile:a,role:"child"}])},children:[(0,d.jsx)(v.S,{checked:b}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("span",{className:"font-medium",children:a.display_name||"—"}),(0,d.jsxs)("span",{className:"text-xs text-muted-foreground ml-2",children:["(",a.ticket_number||"診察券なし",")"]})]})]},a.id)})}),l.length>0&&(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)(p.J,{className:"text-sm font-semibold",children:["追加するメンバー (",l.length,"人)"]}),(0,d.jsx)("div",{className:"space-y-2",children:l.map(a=>(0,d.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg border",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,d.jsx)("span",{className:"font-medium",children:a.profile.display_name||"—"}),(0,d.jsx)("span",{className:"text-xs text-muted-foreground",children:a.profile.ticket_number||"—"})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)(r.l6,{value:a.role,onValueChange:b=>{var c;return c=a.profile.id,void m(l.map(a=>a.profile.id===c?{...a,role:b}:a))},children:[(0,d.jsx)(r.bq,{className:"w-[120px]",children:(0,d.jsx)(r.yv,{})}),(0,d.jsxs)(r.gC,{children:[(0,d.jsx)(r.eb,{value:"parent",children:"保護者"}),(0,d.jsx)(r.eb,{value:"child",children:"子ども"})]})]}),(0,d.jsx)(i.$,{size:"sm",variant:"ghost",onClick:()=>m(l.filter(b=>b.profile.id!==a.profile.id)),children:"削除"})]})]},a.profile.id))})]})]}),(0,d.jsxs)(q.Es,{className:"gap-2",children:[(0,d.jsx)(i.$,{variant:"outline",onClick:()=>c(!1),disabled:n,children:"キャンセル"}),(0,d.jsx)(i.$,{onClick:A,disabled:n||0===l.length,children:n?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(k.A,{className:"h-4 w-4 mr-2 animate-spin"}),"追加中..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t,{className:"h-4 w-4 mr-2"}),"メンバーを追加"]})})]})]})})}var y=c(78460);function z({family:a,open:b,onOpenChange:c,onSuccess:f}){let[g,h]=(0,e.useState)(a.family_name),[j,l]=(0,e.useState)(!1);async function m(){if(!g.trim())return void alert("家族名を入力してください");if(g.trim()===a.family_name)return void c(!1);l(!0);try{let b=await fetch(`/api/families/${a.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({family_name:g.trim()})});if(!b.ok){let a=await b.json();throw Error(a.error||"家族名の変更に失敗しました")}f(),c(!1)}catch(a){console.error("家族編集エラー:",a),alert(a instanceof Error?a.message:"家族名の変更に失敗しました。もう一度お試しください。")}finally{l(!1)}}return(0,d.jsx)(q.lG,{open:b,onOpenChange:c,children:(0,d.jsxs)(q.Cf,{className:"max-w-md",children:[(0,d.jsx)(q.c7,{children:(0,d.jsxs)(q.L3,{className:"flex items-center gap-2",children:[(0,d.jsx)(y.A,{className:"h-5 w-5"}),"家族名を編集"]})}),(0,d.jsx)("div",{className:"space-y-4 py-4",children:(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(p.J,{htmlFor:"family-name",children:"家族名"}),(0,d.jsx)(o.p,{id:"family-name",value:g,onChange:a=>h(a.target.value),placeholder:"例: 横山浩紀の家族",autoFocus:!0})]})}),(0,d.jsxs)(q.Es,{className:"gap-2",children:[(0,d.jsx)(i.$,{variant:"outline",onClick:()=>c(!1),disabled:j,children:"キャンセル"}),(0,d.jsx)(i.$,{onClick:m,disabled:j||!g.trim(),children:j?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(k.A,{className:"h-4 w-4 mr-2 animate-spin"}),"保存中..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"保存"]})})]})]})})}let A=(0,s.A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function B({family:a,open:b,onOpenChange:c,onSuccess:f}){let[g,h]=(0,e.useState)(!1);async function j(){h(!0);try{let b=await fetch(`/api/families/${a.id}`,{method:"DELETE"});if(!b.ok){let a=await b.json();throw Error(a.error||"家族の解散に失敗しました")}f(),c(!1)}catch(a){console.error("家族解散エラー:",a),alert(a instanceof Error?a.message:"家族の解散に失敗しました。もう一度お試しください。")}finally{h(!1)}}return(0,d.jsx)(q.lG,{open:b,onOpenChange:c,children:(0,d.jsxs)(q.Cf,{className:"max-w-md",children:[(0,d.jsxs)(q.c7,{children:[(0,d.jsxs)(q.L3,{className:"flex items-center gap-2 text-rose-600",children:[(0,d.jsx)(A,{className:"h-5 w-5"}),"家族を解散しますか？"]}),(0,d.jsxs)(q.rr,{className:"pt-4",children:[(0,d.jsx)("strong",{className:"text-foreground",children:a.family_name})," を解散します。",(0,d.jsx)("br",{}),(0,d.jsx)("br",{}),"すべてのメンバーは個別の家族に戻ります。この操作は取り消せません。"]})]}),(0,d.jsxs)(q.Es,{className:"gap-2",children:[(0,d.jsx)(i.$,{variant:"outline",onClick:()=>c(!1),disabled:g,children:"キャンセル"}),(0,d.jsx)(i.$,{variant:"destructive",onClick:j,disabled:g,children:g?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(k.A,{className:"h-4 w-4 mr-2 animate-spin"}),"解散中..."]}):"解散する"})]})]})})}function C({member:a,familyId:b,familyName:c,open:f,onOpenChange:g,onSuccess:h}){let[j,l]=(0,e.useState)(!1);async function m(){l(!0);try{let c=await fetch(`/api/families/${b}/members/${a.id}`,{method:"DELETE"});if(!c.ok){let a=await c.json();throw Error(a.error||"メンバーの削除に失敗しました")}h(),g(!1)}catch(a){console.error("メンバー削除エラー:",a),alert(a instanceof Error?a.message:"メンバーの削除に失敗しました。もう一度お試しください。")}finally{l(!1)}}return(0,d.jsx)(q.lG,{open:f,onOpenChange:g,children:(0,d.jsxs)(q.Cf,{className:"max-w-md",children:[(0,d.jsxs)(q.c7,{children:[(0,d.jsxs)(q.L3,{className:"flex items-center gap-2 text-rose-600",children:[(0,d.jsx)(A,{className:"h-5 w-5"}),"メンバーを削除しますか？"]}),(0,d.jsxs)(q.rr,{className:"pt-4",children:[(0,d.jsx)("strong",{className:"text-foreground",children:a.display_name||"このメンバー"})," を"," ",(0,d.jsx)("strong",{className:"text-foreground",children:c})," から削除します。",(0,d.jsx)("br",{}),(0,d.jsx)("br",{}),"削除されたメンバーは個別の家族に戻ります。","parent"===a.family_role&&(0,d.jsx)("div",{className:"mt-2 p-2 bg-amber-50 text-amber-800 rounded text-sm",children:"⚠️ このメンバーは保護者です。削除できません。"})]})]}),(0,d.jsxs)(q.Es,{className:"gap-2",children:[(0,d.jsx)(i.$,{variant:"outline",onClick:()=>g(!1),disabled:j,children:"キャンセル"}),(0,d.jsx)(i.$,{variant:"destructive",onClick:m,disabled:j||"parent"===a.family_role,children:j?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(k.A,{className:"h-4 w-4 mr-2 animate-spin"}),"削除中..."]}):"削除する"})]})]})})}let D=a=>fetch(a).then(a=>a.json());function E(){let{data:a=[],error:b,isLoading:c}=(0,f.Ay)("/api/families",D),[g,h]=(0,e.useState)(null),[m,n]=(0,e.useState)(null),[o,p]=(0,e.useState)(null),[q,r]=(0,e.useState)(null),[s,t]=(0,e.useState)({key:"total_stamp_count",direction:"desc"}),u=(0,e.useMemo)(()=>{let b=a.filter(a=>a.member_count>=2);return b.sort((a,b)=>{let c="asc"===s.direction?1:-1,d=a=>{switch(s.key){case"family_name":return(a.family_name??"").toLowerCase();case"total_stamp_count":return a.total_stamp_count;case"total_visit_count":return a.total_visit_count;case"member_count":return a.member_count;case"last_family_visit":return a.last_family_visit?Date.parse(a.last_family_visit):0}},e=d(a),f=d(b);return e<f?-1*c:e>f?+c:0}),b},[a,s]);function v(a){t(b=>b.key===a?{key:a,direction:"asc"===b.direction?"desc":"asc"}:{key:a,direction:"asc"})}function w(a){return s.key!==a?(0,d.jsx)("span",{className:"ml-1 text-xs text-slate-400",children:"⇅"}):(0,d.jsx)("span",{className:"ml-1 text-xs text-sky-600 font-semibold",children:"asc"===s.direction?"↑":"↓"})}return b?(0,d.jsx)("p",{className:"text-destructive",children:"家族一覧の取得に失敗しました。しばらくしてから再試行してください。"}):c?(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[(0,d.jsx)(k.A,{className:"h-12 w-12 text-sky-500 animate-spin"}),(0,d.jsx)("p",{className:"text-muted-foreground text-sm",children:"家族データを読み込んでいます..."})]}):(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("p",{className:"text-sm text-muted-foreground",children:[u.length,"件の家族が登録されています（2人以上）"]}),(0,d.jsxs)(i.$,{size:"sm",className:"bg-emerald-600 hover:bg-emerald-700",children:[(0,d.jsx)(l.A,{className:"h-4 w-4 mr-1"}),"家族を作成"]})]}),(0,d.jsx)("div",{className:"overflow-hidden rounded-xl border bg-white/90 shadow-sm",children:(0,d.jsxs)(j.XI,{children:[(0,d.jsx)(j.A0,{children:(0,d.jsxs)(j.Hj,{className:"bg-slate-50/80",children:[(0,d.jsx)(j.nd,{className:"w-[50px]"}),(0,d.jsx)(j.nd,{onClick:()=>v("family_name"),className:"cursor-pointer select-none",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["家族名",w("family_name")]})}),(0,d.jsx)(j.nd,{onClick:()=>v("member_count"),className:"cursor-pointer select-none",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["メンバー数",w("member_count")]})}),(0,d.jsx)(j.nd,{onClick:()=>v("total_stamp_count"),className:"cursor-pointer select-none",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["家族合計スタンプ",w("total_stamp_count")]})}),(0,d.jsx)(j.nd,{onClick:()=>v("total_visit_count"),className:"cursor-pointer select-none",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["家族合計来院回数",w("total_visit_count")]})}),(0,d.jsx)(j.nd,{onClick:()=>v("last_family_visit"),className:"cursor-pointer select-none",children:(0,d.jsxs)("span",{className:"inline-flex items-center gap-1",children:["最終来院日",w("last_family_visit")]})}),(0,d.jsx)(j.nd,{children:"操作"})]})}),(0,d.jsx)(j.BF,{children:0===u.length?(0,d.jsx)(j.Hj,{children:(0,d.jsx)(j.nA,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"家族データがありません。"})}):u.map(a=>(0,d.jsx)(F,{family:a,isExpanded:g===a.family_id,onToggleExpand:()=>{var b;return b=a.family_id,void h(a=>a===b?null:b)},onAddMember:a=>n(a),onEdit:(b,c)=>p({id:b,family_name:c,representative_user_id:a.representative_user_id,created_at:a.created_at,updated_at:a.updated_at}),onDelete:(b,c)=>r({id:b,family_name:c,representative_user_id:a.representative_user_id,created_at:a.created_at,updated_at:a.updated_at})},a.family_id))})]})}),m&&(0,d.jsx)(x,{family:m,open:!!m,onOpenChange:a=>!a&&n(null),onSuccess:()=>{n(null)}}),o&&(0,d.jsx)(z,{family:o,open:!!o,onOpenChange:a=>!a&&p(null),onSuccess:()=>{p(null)}}),q&&(0,d.jsx)(B,{family:q,open:!!q,onOpenChange:a=>!a&&r(null),onSuccess:()=>{r(null),h(null)}})]})}function F({family:a,isExpanded:b,onToggleExpand:c,onAddMember:o,onEdit:p,onDelete:q}){let{data:r,isLoading:s}=(0,f.Ay)(b?`/api/families/${a.family_id}`:null,D),t=r?.members||[],[u,v]=(0,e.useState)(null);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(j.Hj,{className:"hover:bg-slate-50/80 transition-colors",children:[(0,d.jsx)(j.nA,{children:(0,d.jsx)(i.$,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:c,children:b?(0,d.jsx)(m.A,{className:"h-4 w-4"}):(0,d.jsx)(n.A,{className:"h-4 w-4"})})}),(0,d.jsx)(j.nA,{className:"font-medium",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(l.A,{className:"h-4 w-4 text-slate-400"}),a.family_name]})}),(0,d.jsx)(j.nA,{children:(0,d.jsxs)(h.E,{variant:"outline",className:"font-semibold",children:[a.member_count,"人"]})}),(0,d.jsx)(j.nA,{children:(0,d.jsx)(h.E,{variant:"secondary",className:"font-semibold",children:a.total_stamp_count})}),(0,d.jsx)(j.nA,{children:(0,d.jsxs)(h.E,{variant:"secondary",className:"font-semibold",children:[a.total_visit_count,"回"]})}),(0,d.jsx)(j.nA,{className:"text-muted-foreground text-xs whitespace-nowrap",children:a.last_family_visit?(0,g.B)(a.last_family_visit):"—"}),(0,d.jsx)(j.nA,{children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(i.$,{size:"sm",variant:"outline",onClick:()=>p(a.family_id,a.family_name),children:"編集"}),(0,d.jsx)(i.$,{size:"sm",variant:"outline",className:"text-rose-600 hover:text-rose-700",onClick:()=>q(a.family_id,a.family_name),children:"解散"})]})})]}),b&&(0,d.jsx)(j.Hj,{children:(0,d.jsx)(j.nA,{colSpan:7,className:"bg-slate-50/50 p-0",children:(0,d.jsx)("div",{className:"p-4 pl-12",children:s?(0,d.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground py-2",children:[(0,d.jsx)(k.A,{className:"h-4 w-4 animate-spin"}),"メンバー情報を読み込んでいます..."]}):0===t.length?(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"メンバー情報がありません"}):(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("p",{className:"text-xs font-semibold text-slate-600 mb-3",children:"家族メンバー"}),(0,d.jsx)("div",{className:"grid gap-2",children:t.map(a=>(0,d.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-lg border p-3",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(h.E,{variant:"parent"===a.family_role?"default":"secondary",children:"parent"===a.family_role?"保護者":a.line_user_id?"子（スマホあり）":"子（スマホなし）"}),(0,d.jsx)("span",{className:"font-medium",children:a.display_name||"—"}),(0,d.jsxs)("span",{className:"text-xs text-muted-foreground",children:["診察券: ",a.ticket_number||"—"]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,d.jsxs)("span",{className:"text-muted-foreground",children:["スタンプ: ",(0,d.jsx)("strong",{children:a.stamp_count})]}),(0,d.jsxs)("span",{className:"text-muted-foreground",children:["来院: ",(0,d.jsxs)("strong",{children:[a.visit_count||0,"回"]})]}),(0,d.jsx)(i.$,{size:"sm",variant:"ghost",className:"text-rose-600 hover:text-rose-700",onClick:()=>v(a),children:"削除"})]})]},a.id))}),(0,d.jsx)("div",{className:"mt-4",children:(0,d.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>r&&o(r),children:[(0,d.jsx)(l.A,{className:"h-3.5 w-3.5 mr-1"}),"メンバーを追加"]})})]})})})}),u&&(0,d.jsx)(C,{member:u,familyId:a.family_id,familyName:a.family_name,open:!!u,onOpenChange:a=>!a&&v(null),onSuccess:()=>{v(null)}})]})}},33873:a=>{"use strict";a.exports=require("path")},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},41475:(a,b,c)=>{"use strict";c.d(b,{Tabs:()=>e,TabsContent:()=>h,TabsList:()=>f,TabsTrigger:()=>g});var d=c(97954);let e=(0,d.registerClientReference)(function(){throw Error("Attempted to call Tabs() from the server but Tabs is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\hirok\\Dropbox\\F.ソースデータ\\0A.LINE_LIFE_TSUKUBA\\260209_ManagimentAPPs_01\\components\\ui\\tabs.tsx","Tabs"),f=(0,d.registerClientReference)(function(){throw Error("Attempted to call TabsList() from the server but TabsList is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\hirok\\Dropbox\\F.ソースデータ\\0A.LINE_LIFE_TSUKUBA\\260209_ManagimentAPPs_01\\components\\ui\\tabs.tsx","TabsList"),g=(0,d.registerClientReference)(function(){throw Error("Attempted to call TabsTrigger() from the server but TabsTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\hirok\\Dropbox\\F.ソースデータ\\0A.LINE_LIFE_TSUKUBA\\260209_ManagimentAPPs_01\\components\\ui\\tabs.tsx","TabsTrigger"),h=(0,d.registerClientReference)(function(){throw Error("Attempted to call TabsContent() from the server but TabsContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\hirok\\Dropbox\\F.ソースデータ\\0A.LINE_LIFE_TSUKUBA\\260209_ManagimentAPPs_01\\components\\ui\\tabs.tsx","TabsContent")},46241:(a,b,c)=>{"use strict";c.d(b,{PatientsTable:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call PatientsTable() from the server but PatientsTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\hirok\\Dropbox\\F.ソースデータ\\0A.LINE_LIFE_TSUKUBA\\260209_ManagimentAPPs_01\\components\\admin\\patients-table.tsx","PatientsTable")},53199:(a,b,c)=>{"use strict";c.d(b,{J:()=>j});var d=c(21124),e=c(38301),f=c(71538),g=c(26691),h=c(15514);let i=(0,g.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.b,{ref:c,className:(0,h.cn)(i(),a),...b}));j.displayName=f.b.displayName},55215:(a,b,c)=>{Promise.resolve().then(c.bind(c,88547)),Promise.resolve().then(c.bind(c,46241)),Promise.resolve().then(c.bind(c,41475))},59405:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63463:(a,b,c)=>{Promise.resolve().then(c.bind(c,33508)),Promise.resolve().then(c.bind(c,15373)),Promise.resolve().then(c.bind(c,68877))},64609:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>o});var d=c(75338),e=c(46241),f=c(88547),g=c(41475),h=c(74515);let i=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var j={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let k=(0,h.forwardRef)(({color:a="currentColor",size:b=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:e="",children:f,iconNode:g,...k},l)=>(0,h.createElement)("svg",{ref:l,...j,width:b,height:b,stroke:a,strokeWidth:d?24*Number(c)/Number(b):c,className:i("lucide",e),...k},[...g.map(([a,b])=>(0,h.createElement)(a,b)),...Array.isArray(f)?f:[f]])),l=(a,b)=>{let c=(0,h.forwardRef)(({className:c,...d},e)=>(0,h.createElement)(k,{ref:e,iconNode:b,className:i(`lucide-${a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,c),...d}));return c.displayName=`${a}`,c},m=l("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),n=l("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);function o(){return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)("h1",{className:"text-2xl font-bold",children:"患者管理"}),(0,d.jsxs)(g.Tabs,{defaultValue:"individuals",className:"w-full",children:[(0,d.jsxs)(g.TabsList,{className:"grid w-full max-w-md grid-cols-2",children:[(0,d.jsxs)(g.TabsTrigger,{value:"individuals",className:"flex items-center gap-2",children:[(0,d.jsx)(m,{className:"h-4 w-4"}),"個人一覧"]}),(0,d.jsxs)(g.TabsTrigger,{value:"families",className:"flex items-center gap-2",children:[(0,d.jsx)(n,{className:"h-4 w-4"}),"家族一覧"]})]}),(0,d.jsx)(g.TabsContent,{value:"individuals",className:"mt-6",children:(0,d.jsx)(e.PatientsTable,{})}),(0,d.jsx)(g.TabsContent,{value:"families",className:"mt-6",children:(0,d.jsx)(f.FamiliesTable,{})})]})]})}},68877:(a,b,c)=>{"use strict";c.d(b,{Tabs:()=>h,TabsContent:()=>k,TabsList:()=>i,TabsTrigger:()=>j});var d=c(21124),e=c(38301),f=c(89989),g=c(15514);let h=f.bL,i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.B8,{ref:c,className:(0,g.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...b}));i.displayName=f.B8.displayName;let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.l9,{ref:c,className:(0,g.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...b}));j.displayName=f.l9.displayName;let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.UC,{ref:c,className:(0,g.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...b}));k.displayName=f.UC.displayName},71613:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},78460:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]])},83047:(a,b,c)=>{"use strict";c.d(b,{l6:()=>aI,gC:()=>aN,eb:()=>aO,bq:()=>aK,yv:()=>aJ});var d=c(21124),e=c(38301),f=c(23312);function g(a,[b,c]){return Math.min(c,Math.max(b,a))}var h=c(87868),i=c(43515),j=c(92808),k=c(2332),l=c(10498),m=c(7412),n=c(70904),o=c(69998),p=c(75656),q=c(25122),r=c(61611),s=c(99978),t=Symbol("radix.slottable");function u(a){return e.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===t}var v=c(71700),w=c(11720),x=c(68829),y=c(10350),z=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"});e.forwardRef((a,b)=>(0,d.jsx)(s.sG.span,{...a,ref:b,style:{...z,...a.style}})).displayName="VisuallyHidden";var A=c(61225),B=c(36409),C=[" ","Enter","ArrowUp","ArrowDown"],D=[" ","Enter"],E="Select",[F,G,H]=(0,i.N)(E),[I,J]=(0,k.A)(E,[H,q.Bk]),K=(0,q.Bk)(),[L,M]=I(E),[N,O]=I(E),P=a=>{let{__scopeSelect:b,children:c,open:f,defaultOpen:g,onOpenChange:h,value:i,defaultValue:j,onValueChange:k,dir:m,name:n,autoComplete:o,disabled:r,required:s,form:t}=a,u=K(b),[v,x]=e.useState(null),[y,z]=e.useState(null),[A,B]=e.useState(!1),C=(0,l.jH)(m),[D,G]=(0,w.i)({prop:f,defaultProp:g??!1,onChange:h,caller:E}),[H,I]=(0,w.i)({prop:i,defaultProp:j,onChange:k,caller:E}),J=e.useRef(null),M=!v||t||!!v.closest("form"),[O,P]=e.useState(new Set),Q=Array.from(O).map(a=>a.props.value).join(";");return(0,d.jsx)(q.bL,{...u,children:(0,d.jsxs)(L,{required:s,scope:b,trigger:v,onTriggerChange:x,valueNode:y,onValueNodeChange:z,valueNodeHasChildren:A,onValueNodeHasChildrenChange:B,contentId:(0,p.B)(),value:H,onValueChange:I,open:D,onOpenChange:G,dir:C,triggerPointerDownPosRef:J,disabled:r,children:[(0,d.jsx)(F.Provider,{scope:b,children:(0,d.jsx)(N,{scope:a.__scopeSelect,onNativeOptionAdd:e.useCallback(a=>{P(b=>new Set(b).add(a))},[]),onNativeOptionRemove:e.useCallback(a=>{P(b=>{let c=new Set(b);return c.delete(a),c})},[]),children:c})}),M?(0,d.jsxs)(aA,{"aria-hidden":!0,required:s,tabIndex:-1,name:n,autoComplete:o,value:H,onChange:a=>I(a.target.value),disabled:r,form:t,children:[void 0===H?(0,d.jsx)("option",{value:""}):null,Array.from(O)]},Q):null]})})};P.displayName=E;var Q="SelectTrigger",R=e.forwardRef((a,b)=>{let{__scopeSelect:c,disabled:f=!1,...g}=a,i=K(c),k=M(Q,c),l=k.disabled||f,m=(0,j.s)(b,k.onTriggerChange),n=G(c),o=e.useRef("touch"),[p,r,t]=aC(a=>{let b=n().filter(a=>!a.disabled),c=b.find(a=>a.value===k.value),d=aD(b,a,c);void 0!==d&&k.onValueChange(d.value)}),u=a=>{l||(k.onOpenChange(!0),t()),a&&(k.triggerPointerDownPosRef.current={x:Math.round(a.pageX),y:Math.round(a.pageY)})};return(0,d.jsx)(q.Mz,{asChild:!0,...i,children:(0,d.jsx)(s.sG.button,{type:"button",role:"combobox","aria-controls":k.contentId,"aria-expanded":k.open,"aria-required":k.required,"aria-autocomplete":"none",dir:k.dir,"data-state":k.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":aB(k.value)?"":void 0,...g,ref:m,onClick:(0,h.mK)(g.onClick,a=>{a.currentTarget.focus(),"mouse"!==o.current&&u(a)}),onPointerDown:(0,h.mK)(g.onPointerDown,a=>{o.current=a.pointerType;let b=a.target;b.hasPointerCapture(a.pointerId)&&b.releasePointerCapture(a.pointerId),0===a.button&&!1===a.ctrlKey&&"mouse"===a.pointerType&&(u(a),a.preventDefault())}),onKeyDown:(0,h.mK)(g.onKeyDown,a=>{let b=""!==p.current;a.ctrlKey||a.altKey||a.metaKey||1!==a.key.length||r(a.key),(!b||" "!==a.key)&&C.includes(a.key)&&(u(),a.preventDefault())})})})});R.displayName=Q;var S="SelectValue",T=e.forwardRef((a,b)=>{let{__scopeSelect:c,className:e,style:f,children:g,placeholder:h="",...i}=a,k=M(S,c),{onValueNodeHasChildrenChange:l}=k,m=void 0!==g,n=(0,j.s)(b,k.onValueNodeChange);return(0,x.N)(()=>{l(m)},[l,m]),(0,d.jsx)(s.sG.span,{...i,ref:n,style:{pointerEvents:"none"},children:aB(k.value)?(0,d.jsx)(d.Fragment,{children:h}):g})});T.displayName=S;var U=e.forwardRef((a,b)=>{let{__scopeSelect:c,children:e,...f}=a;return(0,d.jsx)(s.sG.span,{"aria-hidden":!0,...f,ref:b,children:e||"▼"})});U.displayName="SelectIcon";var V=a=>(0,d.jsx)(r.Z,{asChild:!0,...a});V.displayName="SelectPortal";var W="SelectContent",X=e.forwardRef((a,b)=>{let c=M(W,a.__scopeSelect),[g,h]=e.useState();return((0,x.N)(()=>{h(new DocumentFragment)},[]),c.open)?(0,d.jsx)(_,{...a,ref:b}):g?f.createPortal((0,d.jsx)(Y,{scope:a.__scopeSelect,children:(0,d.jsx)(F.Slot,{scope:a.__scopeSelect,children:(0,d.jsx)("div",{children:a.children})})}),g):null});X.displayName=W;var[Y,Z]=I(W),$=function(a){let b=function(a){let b=e.forwardRef((a,b)=>{let{children:c,...d}=a;if(e.isValidElement(c)){var f;let a,g,h=(f=c,(g=(a=Object.getOwnPropertyDescriptor(f.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?f.ref:(g=(a=Object.getOwnPropertyDescriptor(f,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?f.props.ref:f.props.ref||f.ref),i=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==e.Fragment&&(i.ref=b?(0,j.t)(b,h):h),e.cloneElement(c,i)}return e.Children.count(c)>1?e.Children.only(null):null});return b.displayName=`${a}.SlotClone`,b}(a),c=e.forwardRef((a,c)=>{let{children:f,...g}=a,h=e.Children.toArray(f),i=h.find(u);if(i){let a=i.props.children,f=h.map(b=>b!==i?b:e.Children.count(a)>1?e.Children.only(null):e.isValidElement(a)?a.props.children:null);return(0,d.jsx)(b,{...g,ref:c,children:e.isValidElement(a)?e.cloneElement(a,void 0,f):null})}return(0,d.jsx)(b,{...g,ref:c,children:f})});return c.displayName=`${a}.Slot`,c}("SelectContent.RemoveScroll"),_=e.forwardRef((a,b)=>{let{__scopeSelect:c,position:f="item-aligned",onCloseAutoFocus:g,onEscapeKeyDown:i,onPointerDownOutside:k,side:l,sideOffset:p,align:q,alignOffset:r,arrowPadding:s,collisionBoundary:t,collisionPadding:u,sticky:v,hideWhenDetached:w,avoidCollisions:x,...y}=a,z=M(W,c),[C,D]=e.useState(null),[E,F]=e.useState(null),H=(0,j.s)(b,a=>D(a)),[I,J]=e.useState(null),[K,L]=e.useState(null),N=G(c),[O,P]=e.useState(!1),Q=e.useRef(!1);e.useEffect(()=>{if(C)return(0,A.Eq)(C)},[C]),(0,n.Oh)();let R=e.useCallback(a=>{let[b,...c]=N().map(a=>a.ref.current),[d]=c.slice(-1),e=document.activeElement;for(let c of a)if(c===e||(c?.scrollIntoView({block:"nearest"}),c===b&&E&&(E.scrollTop=0),c===d&&E&&(E.scrollTop=E.scrollHeight),c?.focus(),document.activeElement!==e))return},[N,E]),S=e.useCallback(()=>R([I,C]),[R,I,C]);e.useEffect(()=>{O&&S()},[O,S]);let{onOpenChange:T,triggerPointerDownPosRef:U}=z;e.useEffect(()=>{if(C){let a={x:0,y:0},b=b=>{a={x:Math.abs(Math.round(b.pageX)-(U.current?.x??0)),y:Math.abs(Math.round(b.pageY)-(U.current?.y??0))}},c=c=>{a.x<=10&&a.y<=10?c.preventDefault():C.contains(c.target)||T(!1),document.removeEventListener("pointermove",b),U.current=null};return null!==U.current&&(document.addEventListener("pointermove",b),document.addEventListener("pointerup",c,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",c,{capture:!0})}}},[C,T,U]),e.useEffect(()=>{let a=()=>T(!1);return window.addEventListener("blur",a),window.addEventListener("resize",a),()=>{window.removeEventListener("blur",a),window.removeEventListener("resize",a)}},[T]);let[V,X]=aC(a=>{let b=N().filter(a=>!a.disabled),c=b.find(a=>a.ref.current===document.activeElement),d=aD(b,a,c);d&&setTimeout(()=>d.ref.current.focus())}),Z=e.useCallback((a,b,c)=>{let d=!Q.current&&!c;(void 0!==z.value&&z.value===b||d)&&(J(a),d&&(Q.current=!0))},[z.value]),_=e.useCallback(()=>C?.focus(),[C]),ac=e.useCallback((a,b,c)=>{let d=!Q.current&&!c;(void 0!==z.value&&z.value===b||d)&&L(a)},[z.value]),ad="popper"===f?ab:aa,ae=ad===ab?{side:l,sideOffset:p,align:q,alignOffset:r,arrowPadding:s,collisionBoundary:t,collisionPadding:u,sticky:v,hideWhenDetached:w,avoidCollisions:x}:{};return(0,d.jsx)(Y,{scope:c,content:C,viewport:E,onViewportChange:F,itemRefCallback:Z,selectedItem:I,onItemLeave:_,itemTextRefCallback:ac,focusSelectedItem:S,selectedItemText:K,position:f,isPositioned:O,searchRef:V,children:(0,d.jsx)(B.A,{as:$,allowPinchZoom:!0,children:(0,d.jsx)(o.n,{asChild:!0,trapped:z.open,onMountAutoFocus:a=>{a.preventDefault()},onUnmountAutoFocus:(0,h.mK)(g,a=>{z.trigger?.focus({preventScroll:!0}),a.preventDefault()}),children:(0,d.jsx)(m.qW,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:k,onFocusOutside:a=>a.preventDefault(),onDismiss:()=>z.onOpenChange(!1),children:(0,d.jsx)(ad,{role:"listbox",id:z.contentId,"data-state":z.open?"open":"closed",dir:z.dir,onContextMenu:a=>a.preventDefault(),...y,...ae,onPlaced:()=>P(!0),ref:H,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:(0,h.mK)(y.onKeyDown,a=>{let b=a.ctrlKey||a.altKey||a.metaKey;if("Tab"===a.key&&a.preventDefault(),b||1!==a.key.length||X(a.key),["ArrowUp","ArrowDown","Home","End"].includes(a.key)){let b=N().filter(a=>!a.disabled).map(a=>a.ref.current);if(["ArrowUp","End"].includes(a.key)&&(b=b.slice().reverse()),["ArrowUp","ArrowDown"].includes(a.key)){let c=a.target,d=b.indexOf(c);b=b.slice(d+1)}setTimeout(()=>R(b)),a.preventDefault()}})})})})})})});_.displayName="SelectContentImpl";var aa=e.forwardRef((a,b)=>{let{__scopeSelect:c,onPlaced:f,...h}=a,i=M(W,c),k=Z(W,c),[l,m]=e.useState(null),[n,o]=e.useState(null),p=(0,j.s)(b,a=>o(a)),q=G(c),r=e.useRef(!1),t=e.useRef(!0),{viewport:u,selectedItem:v,selectedItemText:w,focusSelectedItem:y}=k,z=e.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&n&&u&&v&&w){let a=i.trigger.getBoundingClientRect(),b=n.getBoundingClientRect(),c=i.valueNode.getBoundingClientRect(),d=w.getBoundingClientRect();if("rtl"!==i.dir){let e=d.left-b.left,f=c.left-e,h=a.left-f,i=a.width+h,j=Math.max(i,b.width),k=g(f,[10,Math.max(10,window.innerWidth-10-j)]);l.style.minWidth=i+"px",l.style.left=k+"px"}else{let e=b.right-d.right,f=window.innerWidth-c.right-e,h=window.innerWidth-a.right-f,i=a.width+h,j=Math.max(i,b.width),k=g(f,[10,Math.max(10,window.innerWidth-10-j)]);l.style.minWidth=i+"px",l.style.right=k+"px"}let e=q(),h=window.innerHeight-20,j=u.scrollHeight,k=window.getComputedStyle(n),m=parseInt(k.borderTopWidth,10),o=parseInt(k.paddingTop,10),p=parseInt(k.borderBottomWidth,10),s=m+o+j+parseInt(k.paddingBottom,10)+p,t=Math.min(5*v.offsetHeight,s),x=window.getComputedStyle(u),y=parseInt(x.paddingTop,10),z=parseInt(x.paddingBottom,10),A=a.top+a.height/2-10,B=v.offsetHeight/2,C=m+o+(v.offsetTop+B);if(C<=A){let a=e.length>0&&v===e[e.length-1].ref.current;l.style.bottom="0px";let b=Math.max(h-A,B+(a?z:0)+(n.clientHeight-u.offsetTop-u.offsetHeight)+p);l.style.height=C+b+"px"}else{let a=e.length>0&&v===e[0].ref.current;l.style.top="0px";let b=Math.max(A,m+u.offsetTop+(a?y:0)+B);l.style.height=b+(s-C)+"px",u.scrollTop=C-A+u.offsetTop}l.style.margin="10px 0",l.style.minHeight=t+"px",l.style.maxHeight=h+"px",f?.(),requestAnimationFrame(()=>r.current=!0)}},[q,i.trigger,i.valueNode,l,n,u,v,w,i.dir,f]);(0,x.N)(()=>z(),[z]);let[A,B]=e.useState();(0,x.N)(()=>{n&&B(window.getComputedStyle(n).zIndex)},[n]);let C=e.useCallback(a=>{a&&!0===t.current&&(z(),y?.(),t.current=!1)},[z,y]);return(0,d.jsx)(ac,{scope:c,contentWrapper:l,shouldExpandOnScrollRef:r,onScrollButtonChange:C,children:(0,d.jsx)("div",{ref:m,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:A},children:(0,d.jsx)(s.sG.div,{...h,ref:p,style:{boxSizing:"border-box",maxHeight:"100%",...h.style}})})})});aa.displayName="SelectItemAlignedPosition";var ab=e.forwardRef((a,b)=>{let{__scopeSelect:c,align:e="start",collisionPadding:f=10,...g}=a,h=K(c);return(0,d.jsx)(q.UC,{...h,...g,ref:b,align:e,collisionPadding:f,style:{boxSizing:"border-box",...g.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ab.displayName="SelectPopperPosition";var[ac,ad]=I(W,{}),ae="SelectViewport",af=e.forwardRef((a,b)=>{let{__scopeSelect:c,nonce:f,...g}=a,i=Z(ae,c),k=ad(ae,c),l=(0,j.s)(b,i.onViewportChange),m=e.useRef(0);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:f}),(0,d.jsx)(F.Slot,{scope:c,children:(0,d.jsx)(s.sG.div,{"data-radix-select-viewport":"",role:"presentation",...g,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...g.style},onScroll:(0,h.mK)(g.onScroll,a=>{let b=a.currentTarget,{contentWrapper:c,shouldExpandOnScrollRef:d}=k;if(d?.current&&c){let a=Math.abs(m.current-b.scrollTop);if(a>0){let d=window.innerHeight-20,e=Math.max(parseFloat(c.style.minHeight),parseFloat(c.style.height));if(e<d){let f=e+a,g=Math.min(d,f),h=f-g;c.style.height=g+"px","0px"===c.style.bottom&&(b.scrollTop=h>0?h:0,c.style.justifyContent="flex-end")}}}m.current=b.scrollTop})})})]})});af.displayName=ae;var ag="SelectGroup",[ah,ai]=I(ag);e.forwardRef((a,b)=>{let{__scopeSelect:c,...e}=a,f=(0,p.B)();return(0,d.jsx)(ah,{scope:c,id:f,children:(0,d.jsx)(s.sG.div,{role:"group","aria-labelledby":f,...e,ref:b})})}).displayName=ag;var aj="SelectLabel",ak=e.forwardRef((a,b)=>{let{__scopeSelect:c,...e}=a,f=ai(aj,c);return(0,d.jsx)(s.sG.div,{id:f.id,...e,ref:b})});ak.displayName=aj;var al="SelectItem",[am,an]=I(al),ao=e.forwardRef((a,b)=>{let{__scopeSelect:c,value:f,disabled:g=!1,textValue:i,...k}=a,l=M(al,c),m=Z(al,c),n=l.value===f,[o,q]=e.useState(i??""),[r,t]=e.useState(!1),u=(0,j.s)(b,a=>m.itemRefCallback?.(a,f,g)),v=(0,p.B)(),w=e.useRef("touch"),x=()=>{g||(l.onValueChange(f),l.onOpenChange(!1))};if(""===f)throw Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,d.jsx)(am,{scope:c,value:f,disabled:g,textId:v,isSelected:n,onItemTextChange:e.useCallback(a=>{q(b=>b||(a?.textContent??"").trim())},[]),children:(0,d.jsx)(F.ItemSlot,{scope:c,value:f,disabled:g,textValue:o,children:(0,d.jsx)(s.sG.div,{role:"option","aria-labelledby":v,"data-highlighted":r?"":void 0,"aria-selected":n&&r,"data-state":n?"checked":"unchecked","aria-disabled":g||void 0,"data-disabled":g?"":void 0,tabIndex:g?void 0:-1,...k,ref:u,onFocus:(0,h.mK)(k.onFocus,()=>t(!0)),onBlur:(0,h.mK)(k.onBlur,()=>t(!1)),onClick:(0,h.mK)(k.onClick,()=>{"mouse"!==w.current&&x()}),onPointerUp:(0,h.mK)(k.onPointerUp,()=>{"mouse"===w.current&&x()}),onPointerDown:(0,h.mK)(k.onPointerDown,a=>{w.current=a.pointerType}),onPointerMove:(0,h.mK)(k.onPointerMove,a=>{w.current=a.pointerType,g?m.onItemLeave?.():"mouse"===w.current&&a.currentTarget.focus({preventScroll:!0})}),onPointerLeave:(0,h.mK)(k.onPointerLeave,a=>{a.currentTarget===document.activeElement&&m.onItemLeave?.()}),onKeyDown:(0,h.mK)(k.onKeyDown,a=>{(m.searchRef?.current===""||" "!==a.key)&&(D.includes(a.key)&&x()," "===a.key&&a.preventDefault())})})})})});ao.displayName=al;var ap="SelectItemText",aq=e.forwardRef((a,b)=>{let{__scopeSelect:c,className:g,style:h,...i}=a,k=M(ap,c),l=Z(ap,c),m=an(ap,c),n=O(ap,c),[o,p]=e.useState(null),q=(0,j.s)(b,a=>p(a),m.onItemTextChange,a=>l.itemTextRefCallback?.(a,m.value,m.disabled)),r=o?.textContent,t=e.useMemo(()=>(0,d.jsx)("option",{value:m.value,disabled:m.disabled,children:r},m.value),[m.disabled,m.value,r]),{onNativeOptionAdd:u,onNativeOptionRemove:v}=n;return(0,x.N)(()=>(u(t),()=>v(t)),[u,v,t]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.sG.span,{id:m.textId,...i,ref:q}),m.isSelected&&k.valueNode&&!k.valueNodeHasChildren?f.createPortal(i.children,k.valueNode):null]})});aq.displayName=ap;var ar="SelectItemIndicator",as=e.forwardRef((a,b)=>{let{__scopeSelect:c,...e}=a;return an(ar,c).isSelected?(0,d.jsx)(s.sG.span,{"aria-hidden":!0,...e,ref:b}):null});as.displayName=ar;var at="SelectScrollUpButton",au=e.forwardRef((a,b)=>{let c=Z(at,a.__scopeSelect),f=ad(at,a.__scopeSelect),[g,h]=e.useState(!1),i=(0,j.s)(b,f.onScrollButtonChange);return(0,x.N)(()=>{if(c.viewport&&c.isPositioned){let a=function(){h(b.scrollTop>0)},b=c.viewport;return a(),b.addEventListener("scroll",a),()=>b.removeEventListener("scroll",a)}},[c.viewport,c.isPositioned]),g?(0,d.jsx)(ax,{...a,ref:i,onAutoScroll:()=>{let{viewport:a,selectedItem:b}=c;a&&b&&(a.scrollTop=a.scrollTop-b.offsetHeight)}}):null});au.displayName=at;var av="SelectScrollDownButton",aw=e.forwardRef((a,b)=>{let c=Z(av,a.__scopeSelect),f=ad(av,a.__scopeSelect),[g,h]=e.useState(!1),i=(0,j.s)(b,f.onScrollButtonChange);return(0,x.N)(()=>{if(c.viewport&&c.isPositioned){let a=function(){let a=b.scrollHeight-b.clientHeight;h(Math.ceil(b.scrollTop)<a)},b=c.viewport;return a(),b.addEventListener("scroll",a),()=>b.removeEventListener("scroll",a)}},[c.viewport,c.isPositioned]),g?(0,d.jsx)(ax,{...a,ref:i,onAutoScroll:()=>{let{viewport:a,selectedItem:b}=c;a&&b&&(a.scrollTop=a.scrollTop+b.offsetHeight)}}):null});aw.displayName=av;var ax=e.forwardRef((a,b)=>{let{__scopeSelect:c,onAutoScroll:f,...g}=a,i=Z("SelectScrollButton",c),j=e.useRef(null),k=G(c),l=e.useCallback(()=>{null!==j.current&&(window.clearInterval(j.current),j.current=null)},[]);return e.useEffect(()=>()=>l(),[l]),(0,x.N)(()=>{let a=k().find(a=>a.ref.current===document.activeElement);a?.ref.current?.scrollIntoView({block:"nearest"})},[k]),(0,d.jsx)(s.sG.div,{"aria-hidden":!0,...g,ref:b,style:{flexShrink:0,...g.style},onPointerDown:(0,h.mK)(g.onPointerDown,()=>{null===j.current&&(j.current=window.setInterval(f,50))}),onPointerMove:(0,h.mK)(g.onPointerMove,()=>{i.onItemLeave?.(),null===j.current&&(j.current=window.setInterval(f,50))}),onPointerLeave:(0,h.mK)(g.onPointerLeave,()=>{l()})})}),ay=e.forwardRef((a,b)=>{let{__scopeSelect:c,...e}=a;return(0,d.jsx)(s.sG.div,{"aria-hidden":!0,...e,ref:b})});ay.displayName="SelectSeparator";var az="SelectArrow";e.forwardRef((a,b)=>{let{__scopeSelect:c,...e}=a,f=K(c),g=M(az,c),h=Z(az,c);return g.open&&"popper"===h.position?(0,d.jsx)(q.i3,{...f,...e,ref:b}):null}).displayName=az;var aA=e.forwardRef(({__scopeSelect:a,value:b,...c},f)=>{let g=e.useRef(null),h=(0,j.s)(f,g),i=(0,y.Z)(b);return e.useEffect(()=>{let a=g.current;if(!a)return;let c=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value").set;if(i!==b&&c){let d=new Event("change",{bubbles:!0});c.call(a,b),a.dispatchEvent(d)}},[i,b]),(0,d.jsx)(s.sG.select,{...c,style:{...z,...c.style},ref:h,defaultValue:b})});function aB(a){return""===a||void 0===a}function aC(a){let b=(0,v.c)(a),c=e.useRef(""),d=e.useRef(0),f=e.useCallback(a=>{let e=c.current+a;b(e),function a(b){c.current=b,window.clearTimeout(d.current),""!==b&&(d.current=window.setTimeout(()=>a(""),1e3))}(e)},[b]),g=e.useCallback(()=>{c.current="",window.clearTimeout(d.current)},[]);return e.useEffect(()=>()=>window.clearTimeout(d.current),[]),[c,f,g]}function aD(a,b,c){var d,e;let f=b.length>1&&Array.from(b).every(a=>a===b[0])?b[0]:b,g=c?a.indexOf(c):-1,h=(d=a,e=Math.max(g,0),d.map((a,b)=>d[(e+b)%d.length]));1===f.length&&(h=h.filter(a=>a!==c));let i=h.find(a=>a.textValue.toLowerCase().startsWith(f.toLowerCase()));return i!==c?i:void 0}aA.displayName="SelectBubbleInput";var aE=c(85351);let aF=(0,c(23339).A)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var aG=c(71613),aH=c(15514);let aI=P,aJ=T,aK=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(R,{ref:e,className:(0,aH.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...c,children:[b,(0,d.jsx)(U,{asChild:!0,children:(0,d.jsx)(aE.A,{className:"h-4 w-4 opacity-50"})})]}));aK.displayName=R.displayName;let aL=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(au,{ref:c,className:(0,aH.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,d.jsx)(aF,{className:"h-4 w-4"})}));aL.displayName=au.displayName;let aM=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(aw,{ref:c,className:(0,aH.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,d.jsx)(aE.A,{className:"h-4 w-4"})}));aM.displayName=aw.displayName;let aN=e.forwardRef(({className:a,children:b,position:c="popper",...e},f)=>(0,d.jsx)(V,{children:(0,d.jsxs)(X,{ref:f,className:(0,aH.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:c,...e,children:[(0,d.jsx)(aL,{}),(0,d.jsx)(af,{className:(0,aH.cn)("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:b}),(0,d.jsx)(aM,{})]})}));aN.displayName=X.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(ak,{ref:c,className:(0,aH.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...b})).displayName=ak.displayName;let aO=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(ao,{ref:e,className:(0,aH.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(as,{children:(0,d.jsx)(aG.A,{className:"h-4 w-4"})})}),(0,d.jsx)(aq,{children:b})]}));aO.displayName=ao.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(ay,{ref:c,className:(0,aH.cn)("-mx-1 my-1 h-px bg-muted",a),...b})).displayName=ay.displayName},85351:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},88285:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},88547:(a,b,c)=>{"use strict";c.d(b,{FamiliesTable:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call FamiliesTable() from the server but FamiliesTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\hirok\\Dropbox\\F.ソースデータ\\0A.LINE_LIFE_TSUKUBA\\260209_ManagimentAPPs_01\\components\\admin\\families-table.tsx","FamiliesTable")},92500:(a,b,c)=>{"use strict";c.d(b,{S:()=>E});var d=c(21124),e=c(38301),f=c(92808),g=c(2332),h=c(87868),i=c(11720),j=c(10350),k=c(96386),l=c(29988),m=c(99978),n="Checkbox",[o,p]=(0,g.A)(n),[q,r]=o(n);function s(a){let{__scopeCheckbox:b,checked:c,children:f,defaultChecked:g,disabled:h,form:j,name:k,onCheckedChange:l,required:m,value:o="on",internal_do_not_use_render:p}=a,[r,s]=(0,i.i)({prop:c,defaultProp:g??!1,onChange:l,caller:n}),[t,u]=e.useState(null),[v,w]=e.useState(null),x=e.useRef(!1),y=!t||!!j||!!t.closest("form"),z={checked:r,disabled:h,setChecked:s,control:t,setControl:u,name:k,form:j,value:o,hasConsumerStoppedPropagationRef:x,required:m,defaultChecked:!A(g)&&g,isFormControl:y,bubbleInput:v,setBubbleInput:w};return(0,d.jsx)(q,{scope:b,...z,children:"function"==typeof p?p(z):f})}var t="CheckboxTrigger",u=e.forwardRef(({__scopeCheckbox:a,onKeyDown:b,onClick:c,...g},i)=>{let{control:j,value:k,disabled:l,checked:n,required:o,setControl:p,setChecked:q,hasConsumerStoppedPropagationRef:s,isFormControl:u,bubbleInput:v}=r(t,a),w=(0,f.s)(i,p),x=e.useRef(n);return e.useEffect(()=>{let a=j?.form;if(a){let b=()=>q(x.current);return a.addEventListener("reset",b),()=>a.removeEventListener("reset",b)}},[j,q]),(0,d.jsx)(m.sG.button,{type:"button",role:"checkbox","aria-checked":A(n)?"mixed":n,"aria-required":o,"data-state":B(n),"data-disabled":l?"":void 0,disabled:l,value:k,...g,ref:w,onKeyDown:(0,h.mK)(b,a=>{"Enter"===a.key&&a.preventDefault()}),onClick:(0,h.mK)(c,a=>{q(a=>!!A(a)||!a),v&&u&&(s.current=a.isPropagationStopped(),s.current||a.stopPropagation())})})});u.displayName=t;var v=e.forwardRef((a,b)=>{let{__scopeCheckbox:c,name:e,checked:f,defaultChecked:g,required:h,disabled:i,value:j,onCheckedChange:k,form:l,...m}=a;return(0,d.jsx)(s,{__scopeCheckbox:c,checked:f,defaultChecked:g,disabled:i,required:h,onCheckedChange:k,name:e,form:l,value:j,internal_do_not_use_render:({isFormControl:a})=>(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(u,{...m,ref:b,__scopeCheckbox:c}),a&&(0,d.jsx)(z,{__scopeCheckbox:c})]})})});v.displayName=n;var w="CheckboxIndicator",x=e.forwardRef((a,b)=>{let{__scopeCheckbox:c,forceMount:e,...f}=a,g=r(w,c);return(0,d.jsx)(l.C,{present:e||A(g.checked)||!0===g.checked,children:(0,d.jsx)(m.sG.span,{"data-state":B(g.checked),"data-disabled":g.disabled?"":void 0,...f,ref:b,style:{pointerEvents:"none",...a.style}})})});x.displayName=w;var y="CheckboxBubbleInput",z=e.forwardRef(({__scopeCheckbox:a,...b},c)=>{let{control:g,hasConsumerStoppedPropagationRef:h,checked:i,defaultChecked:l,required:n,disabled:o,name:p,value:q,form:s,bubbleInput:t,setBubbleInput:u}=r(y,a),v=(0,f.s)(c,u),w=(0,j.Z)(i),x=(0,k.X)(g);e.useEffect(()=>{if(!t)return;let a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,b=!h.current;if(w!==i&&a){let c=new Event("click",{bubbles:b});t.indeterminate=A(i),a.call(t,!A(i)&&i),t.dispatchEvent(c)}},[t,w,i,h]);let z=e.useRef(!A(i)&&i);return(0,d.jsx)(m.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:l??z.current,required:n,disabled:o,name:p,value:q,form:s,...b,tabIndex:-1,ref:v,style:{...b.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function A(a){return"indeterminate"===a}function B(a){return A(a)?"indeterminate":a?"checked":"unchecked"}z.displayName=y;var C=c(71613),D=c(15514);let E=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(v,{ref:c,className:(0,D.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...b,children:(0,d.jsx)(x,{className:(0,D.cn)("flex items-center justify-center text-current"),children:(0,d.jsx)(C.A,{className:"h-4 w-4"})})}));E.displayName=v.displayName},96386:(a,b,c)=>{"use strict";c.d(b,{X:()=>f});var d=c(38301),e=c(68829);function f(a){let[b,c]=d.useState(void 0);return(0,e.N)(()=>{if(a){c({width:a.offsetWidth,height:a.offsetHeight});let b=new ResizeObserver(b=>{let d,e;if(!Array.isArray(b)||!b.length)return;let f=b[0];if("borderBoxSize"in f){let a=f.borderBoxSize,b=Array.isArray(a)?a[0]:a;d=b.inlineSize,e=b.blockSize}else d=a.offsetWidth,e=a.offsetHeight;c({width:d,height:e})});return b.observe(a,{box:"border-box"}),()=>b.unobserve(a)}c(void 0)},[a]),b}}};var b=require("../../webpack-runtime.js");b.C(a);var c=b.X(0,[331,361,991,842,300,968,85],()=>b(b.s=5868));module.exports=c})();