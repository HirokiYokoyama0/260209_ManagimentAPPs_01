# 管理ダッシュボード メニュー構造化案

**作成日:** 2026-02-24  
**対象:** `components/admin-header.tsx` のナビゲーション

---

## 1. 現状のメニュー（フラット一覧）

| 順序 | ラベル           | パス                    | 備考           |
|------|------------------|-------------------------|----------------|
| 1    | 患者一覧         | /admin                  | メイン         |
| 2    | 分析             | /admin/analysis         |                |
| 3    | 一斉配信         | /admin/broadcast        |                |
| 4    | 特典交換         | /admin/reward-exchanges |                |
| 5    | テストQR         | /admin/qr               | ツール         |
| 6    | スタッフ操作ログ | /admin/activity-logs    | ログ           |
| 7    | ユーザログ       | /admin/user-logs        | ログ           |
| 8    | パスワード変更   | /admin/change-password  | アカウント     |
| 9    | ログアウト       | (POST)                  | アカウント     |

- すべて同列で並んでおり、役割の違いが視覚的に分かりにくい。
- スマホでは縦に長く、スクロールが増える。

---

## 2. グループ分けの考え方

| グループ       | 役割           | 想定項目                                   |
|----------------|----------------|--------------------------------------------|
| **メイン業務** | 日々の運用     | 患者一覧、分析、一斉配信、特典交換         |
| **ツール**     | 補助・検証用   | テストQR など（将来: 家族一覧など）         |
| **ログ**       | 監査・分析用   | スタッフ操作ログ、ユーザログ               |
| **アカウント** | 自分用設定     | パスワード変更、ログアウト                 |

※「スタンプ」「メッセージ」は患者一覧画面内の操作のため、トップメニューには出さない。

---

## 3. レイアウト案

### 案A: 区切り線でグループ表示（サブメニューなし）

```
[ ロゴ・タイトル ]  |  患者一覧  分析  一斉配信  特典交換  |  テストQR  |  スタッフ操作ログ  ユーザログ  |  パスワード変更  [ ログアウト ]
                    ↑ メイン業務                           ↑ ツール    ↑ ログ                              ↑ アカウント
```

- **メリット:** 実装が簡単。現状のリンクを並べたまま、間に区切り（`|` や縦線）を入れるだけ。
- **デメリット:** 項目数は減らない。スマホでは縦並びのまま。

---

### 案B: ドロップダウンでサブメニュー化（推奨）

**PC レイアウト:**

```
[ ロゴ・タイトル ]    患者一覧  分析  一斉配信  特典交換    [ ツール ▼ ]   [ ログ ▼ ]     [ アカウント ▼ ]
                                                                             ├ スタッフ操作ログ     ├ パスワード変更
                                                                             └ ユーザログ          └ ログアウト
                                                                  ├ テストQR
                                                                  └ （将来: 家族一覧 など）
```

- **メイン業務:** そのまま横並び（患者一覧・分析・一斉配信・特典交換）。
- **ツール:** ドロップダウン「ツール」→ テストQR、将来は家族一覧など。
- **ログ:** ドロップダウン「ログ」→ スタッフ操作ログ、ユーザログ。
- **アカウント:** ドロップダウン「アカウント」または右端にユーザ名 + ドロップダウン → パスワード変更、ログアウト。

**スマホ:** ハンバーガー内をセクション分け。

```
--- メイン ---
患者一覧
分析
一斉配信
特典交換
--- ツール ---
テストQR
--- ログ ---
スタッフ操作ログ
ユーザログ
--- アカウント ---
〇〇 でログイン中
パスワード変更
ログアウト
```

- **メリット:** 項目が整理され、拡張しやすい。PC でヘッダーがすっきりする。
- **デメリット:** ドロップダウン UI の実装が必要。

---

### 案C: メイン + 右側に「ログ」「アカウント」のみドロップダウン

- メイン業務・テストQR は現状どおり横並び。
- 「ログ」だけドロップダウン（スタッフ操作ログ・ユーザログ）。
- 右端は「パスワード変更」リンク + 「ログアウト」ボタン、または「アカウント」ドロップダウン（パスワード変更 + ログアウト）。

- **メリット:** 案B より変更が少ない。ログがまとまる。
- **デメリット:** ツールはまだフラット。

---

## 4. 推奨: 案B のデータ構造例

ナビゲーションをデータ駆動にすると、サブメニュー追加・順序変更がしやすい。

```ts
// 例: lib/nav-config.ts または admin-header 内
const mainNav = [
  { label: "患者一覧", href: "/admin" },
  { label: "分析", href: "/admin/analysis" },
  { label: "一斉配信", href: "/admin/broadcast" },
  { label: "特典交換", href: "/admin/reward-exchanges" },
] as const;

const toolNav = [
  { label: "テストQR", href: "/admin/qr" },
  // { label: "家族一覧", href: "/admin/families" },
] as const;

const logNav = [
  { label: "スタッフ操作ログ", href: "/admin/activity-logs" },
  { label: "ユーザログ", href: "/admin/user-logs" },
] as const;

const accountNav = [
  { label: "パスワード変更", href: "/admin/change-password" },
  { label: "ログアウト", action: "logout" },
] as const;
```

- ドロップダウンは shadcn/ui の `DropdownMenu` を使用する想定。

---

## 5. 実装の優先順位

| 優先度 | 内容 |
|--------|------|
| 1      | **案C** から着手: 「ログ」をドロップダウンにまとめる。PC・スマホ両方でセクション見出し「ログ」を追加。 |
| 2      | 右端を「アカウント」ドロップダウン化（パスワード変更 + ログアウト）。必要なら「〇〇 でログイン中」をトリガーに。 |
| 3      | 「ツール」ドロップダウン化（テストQR など）。将来の家族一覧もここに追加。 |
| 4      | ナビゲーションを上記のような定数に外出しし、`admin-header.tsx` はそれを map して描画。 |

---

## 6. まとめ

- **レイアウト:** 左にメイン業務（患者一覧・分析・一斉配信・特典交換）、右にツール・ログ・アカウント。ログとアカウントはドロップダウンでまとめる。
- **サブメニュー:** 「ログ」（スタッフ操作ログ、ユーザログ）、「アカウント」（パスワード変更、ログアウト）、必要なら「ツール」（テストQR）。
- **スマホ:** ハンバーガー内を「メイン / ツール / ログ / アカウント」のセクションに分け、見出しを付ける。

この案で進める場合、まずは「ログ」のドロップダウン化から実装するのがおすすめです。

---

## 7. 実装メモ（案C 反映 2026-02-24）

- **実施内容:** 案C（ログのみドロップダウン + 区切り線でグループ分け）
- **変更ファイル:**
  - `lib/admin-nav.ts` … メイン・ツール・ログ・アカウントのナビ定義。分析は将来サブメニュー化しやすいよう配列で定義。
  - `components/admin-header.tsx` … PC: 区切り線（`navSeparator`）で メイン | ツール | ログ▼ | アカウント。スマホ: セクション見出し「メイン」「ツール」「ログ」「アカウント」+ 区切り線。
- **分析の拡張:** `mainNav` に分析用サブ項目を追加するか、分析をドロップダウンに切り替える場合は `lib/admin-nav.ts` の `mainNav` を編集し、ヘッダー側で「分析」を DropdownMenu で描画するようにすればよい。
